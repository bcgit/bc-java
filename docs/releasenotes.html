<html>
<head>
<title>Bouncy Castle Crypto Package - Release Notes</title>
</head>

<body bgcolor="#ffffff" text="#000000#">

<center>
<h1>Bouncy Castle Crypto Package - Release Notes</h1>
<font size=1>
<pre>
</pre>
</font>
</center>
<h2>1.0 Introduction</h2>
<p>
The Bouncy Castle Crypto package is a Java implementation of 
cryptographic algorithms.  The package is organised so that it 
contains a light-weight API suitable for use in any environment
(including the J2ME) with the additional infrastructure
to conform the algorithms to the JCE framework.
</p>
<h2>2.0 Release History</h2>

<h3>2.1.1 Version</h3>
Release: 1.68<br/>
Date:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2020, December 21st.
<h3>2.1.2 Defects Fixed</h3>
<ul>
<li>Some BigIntegers utility methods would fail for BigInteger.ZERO. This has been fixed.</li>
<li>PGPUtil.isKeyRing() was not detecting secret sub-keys in its input. This has been fixed.</li>
<li>The ASN.1 class, ArchiveTimeStamp was insisting on a value for the optional reducedHashTree field. This has been fixed.</li>
<li>BCJSSE: Lock against multiple writers - a possible synchronization issue has been removed.</li>
</ul>
<h3>2.1.3 Additional Features and Functionality</h3>
<ul>
<li>BCJSSE: Added support for system property com.sun.net.ssl.requireCloseNotify. Note that we are using a default value of 'true'.</li>
<li>BCJSSE: 'TLSv1.3' is now a supported protocol for both client and server. For this release it is only enabled by default for the 'TLSv1.3' SSLContext, but can be explicitly enabled using 'setEnabledProtocols' on an SSLSocket or SSLEngine, or via SSLParameters.</li>
<li>BCJSSE: Session resumption is now also supported for servers in TLS 1.2 and earlier. For this release it is disabled by default, and can be enabled by setting the boolean system property org.bouncycastle.jsse.server.enableSessionResumption to 'true'.</li>
<li>The provider RSA-PSS signature names that follow the JCA naming convention.</li>
<li>FIPS mode for the BCJSSE now enforces namedCurves for any presented certificates.</li>
<li>PGPSignatureSubpacketGenerator now supports editing of a pre-existing sub-packet list.</li>
</ul>


<h3>2.2.1 Version</h3>
Release: 1.67<br/>
Date:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2020, November 1st.
<h3>2.2.2 Defects Fixed</h3>
<ul>
<li>BCJSSE: SunJSSE compatibility fix - override of getChannel() removed and 'urgent data' behaviour should now conform to what the SunJSSE expects.
<li>Nested BER data could sometimes cause issues in octet strings. This has been fixed.</li>
<li>Certificates/CRLs with short signatures could cause an exception in toString() in the BC X509 Certificate implmentation. This has been fixed.</li>
<li>In line with latest changes in the JVM, SignatureSpis which don't require parameters now return null on engineGetParameters().</li>
<li>The RSA KeyFactory now always preferentially produces RSAPrivateCrtKey where it can on requests for a KeySpec based on an RSAPrivateKey.</li>
<li>CMSTypedStream$FullReaderStream now handles zero length reads correctly.</li>
<li>Unecessary padding was added on KMAC when the key length was block aligned. This has been fixed.</li>
<li>Zero length data would cause an unexpected exception from RFC5649WrapEngine. This has been fixed.</li>
<li>OpenBSDBcrypt was failing to handle some valid prefixes. This has been fixed.</li>
</ul>
<h3>2.2.3 Additional Features and Functionality</h3>
<ul>
<li>Performance of Argon2 has been improved.</li>
<li>Performance of Noekeon has been improved.</li>
<li>A setSessionKeyObfuscation() method has been added to PublicKeyKeyEncryptionMethodGenerator to allow turning off of session key obfuscation (default is on, method primarily to get around early version GPG issues with AES-128 keys).</li>
<li>Implemented 'safegcd' constant-time modular inversion (as well as a variable-time variant). It has replaced Fermat inversion in all our EC code, and BigInteger.modInverse in several other places, particularly signers. This improves side-channel protection, and also gives a significant performance boost.</li>
<li>Performance of custom binary ECC curves and Edwards Curves has been improved.</li>
<li>BCJSSE: New boolean system property 'org.bouncycastle.jsse.keyManager.checkEKU' allows to disable ExtendedKeyUsage restrictions when selecting credentials (although the peer may still complain).</li>
<li>Initial support has been added for "Composite Keys and Signatures For Use In Internet PKI" using the test OID. Please note there will be further refinements to this as the draft is standardised.</li>
<li>The BC EdDSA signature API now supports keys implementing all methods on the EdECKey and XECKey interfaces directly.</li>
<li>Work has begun on classes to support the ETSI TS 103 097, Intelligent Transport Systems (ITS) in the bcpkix package.</li>
<li>Further optimization work has been done on GCM.</li>
<li>A NewHope based processor, similar to the one for Key Agreement has been added for trying to "quantum hard" KEM algorithms.</li>
<li>PGP clear signed signatures now support SHA-224.</li>
<li>Treating absent vs NULL as equivalent can now be configured by a system property. By default this is not enabled.</li>
<li>Mode name checks in Cipher strings should now make sure an improper mode name always results in a NoSuchAlgorithmException.</li>
<li>In line with changes in OpenSSL, the OpenSSLPBKDF now uses UTF8 encoding.</li>
</ul>
<h3>2.2.4 Security Advisory</h3>
<ul>
<li>As described in CVE-2020-28052, the OpenBSDBCrypt.checkPassword() method had a flaw in it due to a change for BC 1.65. BC 1.66 is also affected. The issue is fixed in BC 1.67. If you are using OpenBSDBCrypt.checkPassword() and you are using BC 1.65 or BC 1.66 we strongly advise moving to BC 1.67 or later.</li>
</ul>

<h3>2.3.1 Version</h3>
Release: 1.66<br/>
Date:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2020, July 4th.
<h3>2.3.2 Defects Fixed</h3>
<ul>
<li>EdDSA verifiers now reset correctly after rejecting overly long signatures.</li>
<li>BCJSSE: SSLSession.getPeerCertificateChain could throw NullPointerException. This has been fixed.</li>
<li>qTESLA-I verifier would reject some valid signatures. This has been fixed.</li>
<li>qTESLA verifiers now reject overly long signatures.</li>
<li>PGP regression caused failure to preserve existing version header when headers were reset. This has now been fixed.</li>
<li>PKIXNameConstraintValidator had a bad cast preventing use of multiple OtherName constraints. This has been fixed.</li>
<li>Serialisation of the non-CRT RSA Private Key could cause a NullPointerException. This has been fixed.</li>
<li>An extra 4 bytes was included in the start of HSS public key encodings. This has been fixed.</li>
<li>CMS with Ed448 using a direct signature was using id-shake256-len rather than id-shake256. This has been fixed.</li>
<li>Use of GCMParameterSpec could cause an AccessControlException under some circumstances. This has been fixed.</li>
<li>DTLS: Fixed high-latency HelloVerifyRequest handshakes.</li>
<li>An encoding bug for rightEncoded() in KMAC has been fixed.</li>
<li>For a few values the cSHAKE implementation would add unnecessary pad bytes where the N and S strings produced encoded data that was block aligned. This has been fixed.</li>
<li>There were a few circumstances where Argon2BytesGenerator might hit an unexpected null. These have been removed.</li>
</ul>
<h3>2.3.3 Additional Features and Functionality</h3>
<ul>
<li>The qTESLA signature algorithm has been updated to v2.8 (20191108).</li>
<li>BCJSSE: Client-side OCSP stapling now supports status_request_v2 extension.</li>
<li>Support has been added for PKIXRevocationChecker for users of Java 8 and later.</li>
<li>Support has been added for "ocsp.enable", "ocsp.responderURL" for users of Java 8 and later.</li>
<li>Support has been added for "org.bouncycastle.x509.enableCRLDP" to the PKIX validator.</li>
<li>BCJSSE: Now supports system property 'jsse.enableFFDHE'</li>
<li>BCJSSE: Now supports system properties 'jdk.tls.client.SignatureSchemes' and 'jdk.tls.server.SignatureSchemes'.</li>
<li>Multi-release support has been added for Java 11 XECKeys.</li>
<li>Multi-release support has been added for Java 15 EdECKeys.</li>
<li>The MiscPEMGenerator will now output general PrivateKeyInfo structures.</li>
<li>A new property "org.bouncycastle.pkcs8.v1_info_only" has been added to make the provider only produce version 1 PKCS8 PrivateKeyInfo structures.</li>
<li>The PKIX CertPathBuilder will now take the target certificate from the target constraints if a specific certificate is given to the selector.</li>
<li>BCJSSE: A range of ARIA and CAMELLIA cipher suites added to supported list.</li>
<li>BCJSSE: Now supports the PSS signature schemes from RFC 8446 (TLS 1.2 onwards).</li>
<li>Performance of the Base64 encoder has been improved.</li>
<li>The PGPPublicKey class will now include direct key sigantures when checking for key expiry times.</li>
</ul>
<h3>2.3.4 Notes</h3>
<p>
The qTESLA update breaks compatibility with previous versions. Private keys now include a hash of the public key at the end, and signatures are no longer interoperable with previous versions.
</p>

<h3>2.4.1 Version</h3>
Release: 1.65<br/>
Date:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2020, March 31st.
<h3>2.4.2 Defects Fixed</h3>
<ul>
<li>DLExternal would encode using DER encoding for tagged SETs. This has been fixed.</li>
<li>ChaCha20Poly1305 could fail for large (&gt;~2GB) files. This has been fixed.</li>
<li>ChaCha20Poly1305 could fail for small updates when used via the provider. This has been fixed.</li>
<li>Properties.getPropertyValue could ignore system property when other local overrides set. This has been fixed.</li>
<li>The entropy gathering thread was not running in daemon mode, meaning there could be a delay in an application shutting down due to it. This has been fixed.</li>
<li>A recent change in Java 11 could cause an exception with the BC Provider's implementation of PSS. This has been fixed.</li>
<li>BCJSSE: TrustManager now tolerates having no trusted certificates.</li>
<li>BCJSSE: Choice of credentials and signing algorithm now respect the peer's signature_algorithms extension properly.</li>
<li>BCJSSE: KeyManager for KeyStoreBuilderParameters no longer leaks memory.</li>
</ul>
<h3>2.4.3 Additional Features and Functionality</h3>
<ul>
<li>LMS and HSS (RFC 8554) support has been added to the low level library and the PQC provider.</li>
<li>SipHash128 support has been added to the low level library and the JCE provider.</li>
<li>BCJSSE: BC API now supports explicitly specifying the session to resume.</li>
<li>BCJSSE: Ed25519, Ed448 are now supported when TLS 1.2 or higher is negotiated (except in FIPS mode).</li>
<li>BCJSSE: Added support for extended_master_secret system properties: jdk.tls.allowLegacyMasterSecret, jdk.tls.allowLegacyResumption, jdk.tls.useExtendedMasterSecret .</li>
<li>BCJSSE: KeyManager and TrustManager now check algorithm constraints for keys and certificate chains.</li>
<li>BCJSSE: KeyManager selection of server credentials now prefers matching SNI hostname (if any).</li>
<li>BCJSSE: KeyManager may now fallback to imperfect credentials (expired, SNI mismatch).</li>
<li>BCJSSE: Client-side OCSP stapling support (beta version: via status_request extension only, provides jdk.tls.client.enableStatusRequestExtension, and requires CertPathBuilder support).</li>
<li>TLS: DSA in JcaTlsCrypto now falls back to stream signing to work around NoneWithDSA limitations in default provider.</li>
</ul>

<h3>2.5.1 Version</h3>
Release: 1.64<br/>
Date:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2019, October 7th.
<h3>2.5.2 Defects Fixed</h3>
<ul>
<li>OpenSSH: Fixed padding in generated Ed25519 private keys.</li>
<li>Validation of headers in PemReader now looks for tailing dashes in header.</li>
<li>PKIXNameConstraintValidator was throwing a NullPointerException on OtherName. This has been fixed.</li>
<li>Some compatibility issues around the signature encryption algorithm field in CMS SignedData and the GOST algorithms have been addressed.</li>
<li>GOST3410-2012-512 now uses the GOST3411-2012-256 as its KDF digest.</li>
</ul>
<h3>2.5.3 Additional Features and Functionality</h3>
<ul>
<li>PKCS12: key stores containing only certificates can now be created without the need to provide passwords.</li>
<li>BCJSSE: Initial support for AlgorithmConstraints; protocol versions and cipher suites.</li>
<li>BCJSSE: Initial support for 'jdk.tls.disabledAlgorithms'; protocol versions and cipher suites.</li>
<li>BCJSSE: Add SecurityManager check to access session context.</li>
<li>BCJSSE: Improved SunJSSE compatibility of the NULL_SESSION.</li>
<li>BCJSSE: SSLContext algorithms updated for SunJSSE compatibility (default enabled protocols).</li>
<li>The digest functions Haraka-256 and Haraka-512 have been added to the provider and the light-weight API</li>
<li>XMSS/XMSS^MT key management now allows for allocating subsets of the private key space using the extraKeyShard() method. Use of StateAwareSignature is now deprecated.</li>
<li>Support for Java 11's NamedParameterSpec class has been added (using reflection) to the EC and EdEC KeyPairGenerator implementations.</li>
</ul>

<h3>2.5.4 Removed Features and Functionality</h3>
<ul>
<li>Deprecated ECPoint 'withCompression' tracking has been removed.</li>
</ul>

<h3>2.5.5 Security Advisory</h3>
<ul>
<li>A change to the ASN.1 parser in 1.63 introduced a regression that can cause an OutOfMemoryError to occur on parsing ASN.1 data. We recommend upgrading to 1.64, particularly where an application might be parsing untrusted ASN.1 data from third parties.</li>
</ul>

<h3>2.6.1 Version</h3>
Release: 1.63<br/>
Date:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2019, September 10th.
<h3>2.6.2 Defects Fixed</h3>
<ul>
<li>The ASN.1 parser would throw a large object exception for some objects which could be safely parsed. This has been fixed.</li>
<li>GOST3412-2015 CTR mode was unusable at the JCE level. This has been fixed.</li>
<li>The DSTU MACs were failing to reset fully on doFinal(). This has been fixed.</li>
<li>The DSTU MACs would throw an exception if the key was a multiple of the size as the MAC's underlying buffer size. This has been fixed.</li>
<li>EdEC and QTESLA were not previously usable with the post Java 9 module structure. This is now fixed.
<li>ECNR was not correctly bounds checking the input and could produce invalid signatures. This is now fixed.</li>
<li>ASN.1: Enforce no leading zeroes in OID branches (longer than 1 character).</li>
<li>TLS: Fix X448 support in JcaTlsCrypto.</li>
<li>Fixed field reduction for secp128r1 custom curve.</li>
<li>Fixed unsigned multiplications in X448 field squaring.</li>
<li>Some issues over subset Name Constraint validation in the CertPath analyser have now been fixed.</li>
<li>TimeStampResponse.getEncoded() could throw an exception if the TimeStampToken was null. This has been fixed.</li>
<li>Unnecessary memory usage in the ARGON2 implementation has been removed.</li>
<li>Param-Z in the GOST-28147 algorithm was not resolving correctly. This has been fixed.</li>
<li>It is now possible to specify different S-Box parameters for the GOST 28147-89 MAC.</li>
</ul>

<h3>2.6.3 Additional Features and Functionality</h3>
<ul>
<li>QTESLA is now updated with the round 2 changes. Note: the security catergories, and in some cases key generation and signatures, have changed. For people interested in comparison, the round 1 version is now moved to org.bouncycastle.pqc.crypto.qteslarnd1 - this package will be deleted in 1.64. Please keep in mind that QTESLA may continue to evolve.</li>
<li>Support has been added for generating Ed25519/Ed448 signed certificates.</li>
<li>A method for recovering the message/digest value from an ECNR signature has been added.</li>
<li>Support for the ZUC-128 and ZUC-256 ciphers and MACs has been added to the provider and the lightweight API.</li>
<li>Support has been added for ChaCha20-Poly1305 AEAD mode from RFC 7539.</li>
<li>Improved performance for multiple ECDSA verifications using same public key.</li>
<li>Support for PBKDF2withHmacSM3 has been added to the BC provider.</li>
<li>The S/MIME API has been fixed to avoid unnecessary delays due to DNS resolution of a hosts name in internal MimeMessage preparation.</li>
<li>The valid path for EST services has been updated to cope with the characters used in the Aruba clearpass EST implementation.</li>
</ul>

<h3>2.7.1 Version</h3>
Release: 1.62<br/>
Date:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2019, June 3rd.
<h3>2.7.2 Defects Fixed</h3>
<ul>
<li>DTLS: Fixed infinite loop on IO exceptions.</li>
<li>DTLS: Retransmission timers now properly apply to flights monolithically.</li>
<li>BCJSSE: setEnabledCipherSuites ignores unsupported cipher suites.</li>
<li>BCJSSE: SSLSocket implementations store passed-in 'host' before connecting.</li>
<li>BCJSSE: Handle SSLEngine closure prior to handshake.</li>
<li>BCJSSE: Provider now configurable using security config under Java 11 and later.</li>
<li>EdDSA verifiers now reject overly long signatures.</li>
<li>XMSS/XMSS^MT OIDs now using the values defined in RFC 8391.</li>
<li>XMSS/XMSS^MT keys now encoded with OID at start.</li>
<li>An error causing valid paths to be rejected due to DN based name constraints has been fixed in the CertPath API.</li>
<li>Name constraint resolution now includes special handling of serial numbers.</li>
<li>Cipher implementations now handle ByteBuffer usage where the ByteBuffer has no backing array.</li>
<li>CertificateFactory now enforces presence of PEM headers when required.</li>
<li>A performance issue with RSA key pair generation that was introduced in 1.61 has been mostly eliminated.</li>
</ul>
<h3>2.7.3 Additional Features and Functionality</h3>
<ul>
<li>Builders for X509 certificates and CRLs now support replace and remove extension methods.</li>
<li>DTLS: Added server-side support for HelloVerifyRequest.</li>
<li>DTLS: Added support for an overall handshake timeout.</li>
<li>DTLS: Added support for the heartbeat extension (RFC 6520).</li>
<li>DTLS: Improve record seq. behaviour in HelloVerifyRequest scenarios.</li>
<li>TLS: BasicTlsPSKIdentity now reusable (returns cloned array from getPSK).</li>
<li>BCJSSE: Improved ALPN support, including selectors from Java 9.</li>
<li>Lightweight RSADigestSigner now support use of NullDigest.</li>
<li>SM2Engine now supports C1C3C2 mode.</li>
<li>SHA256withSM2 now added to provider.</li>
<li>BCJSSE: Added support for ALPN selectors (including in BC extension API for earlier JDKs).</li>
<li>BCJSSE: Support 'SSL' algorithm for SSLContext (alias for 'TLS').</li>
<li>The BLAKE2xs XOF has been added to the lightweight API.</li>
<li>Utility classes added to support journaling of SecureRandom and algorithms to allow persistance and later resumption.</li>
<li>PGP SexprParser now handles some unprotected key types.</li>
<li>NONEwithRSA support added to lightweight RSADigestSigner.</li>
<li>Support for the Ethereum flavor of IES has been added to the lightweight API.</li>
</ul>

<h3>2.8.1 Version</h3>
Release: 1.61<br/>
Date:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2019, February 4th.
<h3>2.8.2 Defects Fixed</h3>
<ul>
<li>Use of EC named curves could be lost if keys were constructed via a key factory and algorithm parameters. This has been fixed.</li>
<li>RFC3211WrapEngine would not properly handle messages longer than 127 bytes. This has been fixed.</li>
<li>The JCE implementations for RFC3211 would not return null AlgorithmParameters. This has been fixed.</li>
<li>TLS: Don't check CCS status for hello_request.</li>
<li>TLS: Tolerate unrecognized hash algorithms.</li>
<li>TLS: Tolerate unrecognized SNI types.</li>
<li>An incompatibility issue in ECIES-KEM encryption in cofactor mode has been fixed.</li>
<li>An issue with XMSS/XMSSMT private key loading which could result in invalid signatures has been fixed.</li>
<li>StateAwareSignature.isSigningCapable() now returns false when the key has reached it's maximum number of signatures.</li>
<li>The McEliece KeyPairGenerator was failing to initialize the underlying class if a SecureRandom was explicitly passed.</li>
<li>The McEliece cipher would sometimes report the wrong value on a call to Cipher.getOutputSize(int). This has been fixed.</li>
<li>CSHAKEDigest.leftEncode() was using the wrong endianness for multi byte values. This has been fixed.</li>
<li>Some ciphers, such as CAST6, were missing AlgorithmParameters implementations. This has been fixed.</li>
<li>An issue with the default "m" parameter for 1024 bit Diffie-Hellman keys which could result in an exception on key pair generation has been fixed.</li>
<li>The SPHINCS256 implementation is now more tolerant of parameters wrapped with a SecureRandom and will not throw an exception if it receives one.</li>
<li>A regression in PGPUtil.writeFileToLiteralData() which could cause corrupted literal data has been fixed.</li>
<li>Several parsing issues related to the processing of CMP PKIPublicationInfo have been fixed.</li>
<li>The ECGOST curves for id-tc26-gost-3410-12-256-paramSetA and id-tc26-gost-3410-12-512-paramSetC had incorrect co-factors. These have been fixed.</li>
</ul>
<h3>2.8.3 Additional Features and Functionality</h3>
<ul>
<li>The qTESLA signature algorithm has been added to PQC light-weight API and the PQC provider.</li>
<li>The password hashing function, Argon2 has been added to the lightweight API.</li>
<li>BCJSSE: Added support for endpoint ID validation (HTTPS, LDAP, LDAPS).</li>
<li>BCJSSE: Added support for 'useCipherSuitesOrder' parameter.</li>
<li>BCJSSE: Added support for ALPN.</li>
<li>BCJSSE: Various changes for improved compatibility with SunJSSE.</li>
<li>BCJSSE: Provide default extended key/trust managers.</li>
<li>TLS: Added support for TLS 1.2 features from RFC 8446.</li>
<li>TLS: Removed support for EC point compression.</li>
<li>TLS: Removed support for record compression.</li>
<li>TLS: Updated to RFC 7627 from draft-ietf-tls-session-hash-04.</li>
<li>TLS: Improved certificate sig. alg. checks.</li>
<li>TLS: Finalised support for RFC 8442 cipher suites.</li>
<li>Support has been added to the main Provider for the Ed25519 and Ed448 signature algorithms.</li>
<li>Support has been added to the main Provider for the X25519 and X448 key agreement algorithms.</li>
<li>Utility classes have been added for handling OpenSSH keys.</li>
<li>Support for processing messages built using GPG and Curve25519 has been added to the OpenPGP API.</li>
<li>The provider now recognises the standard SM3 OID.</li>
<li>A new API for directly parsing and creating S/MIME documents has been added to the PKIX API.</li>
<li>SM2 in public key cipher mode has been added to the provider API.</li>
<li>The BCFKSLoadStoreParameter has been extended to allow the use of certificates and digital signatures for verifying the integrity of BCFKS key stores.</li>
</ul>
<h3>2.8.4 Removed Features and Functionality</h3>
<ul>
<li>Deprecated methods for EC point construction independent of curves have been removed.</li>
</ul>

<h3>2.9.1 Version</h3>
Release: 1.60<br/>
Date:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2018, June 30
<h3>2.9.2 Defects Fixed</h3>
<ul>
<li>Base64/UrlBase64 would throw an exception on a zero length string. This has been fixed.</li>
<li>Base64/UrlBase64 would throw an exception if there was whitespace in the last 4 characters. This has been fixed.</li>
<li>The SM2 Signature JCE class now properly resets of Signature.sign() is called.</li>
<li>XMSS applies further validation to deserialisation of the BDS tree so that failure occurs as soon as tampering is detected (see CVE below).</li>
<li>An off by one error in the JsseDefaultHostnameAuthorizer isValidNameMatch method has been fixed.</li>
<li>BCJSSE: Return empty byte array instead of null, for the null session ID.</li>
<li>If a checksum calculator was passed to a PGPSecretKey constructor, but the encryptor was set to null, the wrong checksum would be calculated for the S2K usage. This has been fixed.</li>
<li>The CRMF EncryptedValue, when containing a private key, held an encoding of an EncryptedPrivateKeyInfo, rather than just the encrypted bytes. This has been fixed.</li>
<li>EC point precomputations could fail due to race conditions in concurrent settings. Point precomputation was reworked to fix this.</li>
<li>PGP key rings containing EdDSA signatures would cause an exception on parsing. This has been fixed.</li>
<li>BCJSSE: a mixed case error for brainpool curves in the supported groups set has been fixed.</li>
<li>getVersion() on the CRMF CertTemplate class could cause a null pointer exception if the optional version field was left out. This has been fixed.</li>
<li>Use of a short buffer with RSA via the JCE could result in an escaping ArrayIndexOutOfBoundsException. This has been fixed so that a ShortBufferException is now thrown.</li>
<li>SM2Engine.decrypt() ignored the offset parameter and assumed zero. This has been fixed.</li>
<li>A PEM encoded TRUSTED CERTIFICATE missing a trust block would result in a NullPointerException. This has been fixed.</li>
<li>If the Sun provider was removed entirely the BC SecureRandom was unable to seed and caused an InstantiationException. A back up seeding strategy has been added to prevent this.</li>
<li>In some situations the use of sm2p256v1 would result in "unknown curve name". This has been fixed.</li>
<li>CMP PollReqContent now supports multiple certificate request IDs.</li>
</ul>
<h3>2.9.3 Additional Features and Functionality</h3>
<ul>
<li>TLS: Extended CBC padding is now optional (and disabled by default).</li>
<li>TLS: Now supports channel binding 'tls-server-end-point'.</li>
<li>TLS: InterruptedIOException (e.g. socket timeout) during app-data reads no longer fails connection; handshake is optionally resumable after IIOE using 'TlsProtocol.setResumableHandshake()'.</li>
<li>TLS: Added utility methods and constants for ALPN (RFC 7301).</li>
<li>BCJSSE: Now supports system property 'jdk.tls.client.protocols'</li>
<li>BCJSSE: Now supports SSLParameters.setSNIMatchers.</li>
<li>BCJSSE: SNI can now be used in earlier JDKs via BC extensions.</li>
<li>BCJSSE: Session context now holds sessions via soft references.</li>
<li>An implementation of CryptoServicesRegistrar has been added to allow configuring of DSA/DH parameters and global setting of the SecureRandom used in the APIs.</li>
<li>Support has been added for the Unified Model of key agreement for both regular Diffie-Hellman and ECCDH.</li>
<li>Standard key-wrapping ciphers can now be used for wrapping other data where the cipher supports it.</li>
<li>BCFKS can now support the use of generalised wrapping algorithms.</li>
<li>A parser has now been added for the GNU keybox file format.</li>
<li>The GPG SExpr parser now covers a wider range of key types and validates associated checksums as well.</li>
<li>PGP EC operations now support more than just NIST curves.</li>
<li>Restrictions on the output sizes of the Blake2b/s digests in the lightweight API have been removed.</li>
<li>The Whirlpool digest OID has been added to its corresponding mappings for the JCA.</li>
<li>Support has been added for SHA-3 based signatures to the CMS API.</li>
<li>Support has been added to the CMS API for the generation of ECGOST key transport messages.</li>
<li>The ECElGamalEncryptor now supports the use of ECGOST curves.</li>
<li>The number of signature subpackets in OpenPGP signatures that are converted into explicit types automatically has been increased.</li>
<li>RFC 8032: Added low-level implementations of Ed25519 and Ed448.</li>
<li>The provider jars now include a services entry for the 2 providers they hold.</li>
<li>Support has been added for the German BSI KAEG Elliptic Curve key agreement algorithm with X9.63 as the KDF to the JCE.</li>
<li>Support has been added for the German BSI KAEG Elliptic Curve session key KDF to the lightweight API.</li>
</ul>
<h3>2.9.4 Security Related Changes and CVE's Addressed by this Release</h3>
<ul>
<li>CVE-2018-1000180: issue around primality tests for RSA key pair generation if done using only the low-level API.</li>
<li>CVE-2018-1000613: lack of class checking in deserialization of XMSS/XMSS^MT private keys with BDS state information.</li>
</ul>

<h3>2.10.1 Version</h3>
Release: 1.59 <br/>
Date:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2017, December 28
<h3>2.10.2 Defects Fixed</h3>
<ul>
<li>Issues with using PQC based keys with the provided BC KeyStores have now been fixed.</li>
<li>ECGOST-2012 public keys were being encoded with the wrong OID for the digest parameter in the algorithm parameter set. This has been fixed.</li>
<li>SM3 has now been added as an acceptable algorithm for TSP timestamps.</li>
<li>SM2 signatures were using the wrong default identity value. This has now been fixed.</li>
<li>An edge condition in Blake2b for hashes on data with a length in the range of 2**64 - 127 to 2**64 has been identifed and fixed.</li>
<li>The ISO Trailer for SHA512/256 used in X9.31 and ISO9796-2 signatures was incorrect. This has been fixed.</li>
<li>The BCJSSE SSLEngine implementation now correctly wraps/unwraps application data only in whole records.</li>
<li>The curve parameters for tc26_gost_3410_12_256_paramSetA were incorrect. These have been fixed.</li>
<li>Further work has been done to try and prevent escaping exceptions on opening random files as BCFKS files or PKCS#12 files.</li>
<li>An off-by-one error for the max N check for SCRYPT has been fixed. SCRYPT should now be compliant with RFC 7914.</li>
<li>ASN1GeneralizedTime will now accept a broader range of input strings.</li>
</ul>
<h3>2.10.3 Additional Features and Functionality</h3>
<ul>
<li>GOST3410-94 private keys encoded using ASN.1 INTEGER are now accepted in private key info objects.</li>
<li>SCRYPT is now supported as a SecretKeyFactory in the provider and in the PKCS8 APIs</li>
<li>The BCJSSE provider now supports session resumption in clients.</li>
<li>The BCJSSE provider now supports Server Name Indication.</li>
<li>The BCJSSE provider now supports the jdk.tls.namedGroups system property.</li>
<li>The BCJSSE provider now supports the org.bouncycastle.jsse.ec.disableChar2 system property, which optionally disables the use of characteristic-2 elliptic curves.</li>
<li>EC key generation and signing now use cache-timing resistant table lookups.</li>
<li>Performance of the DSTU algorithms has been greatly improved.</li>
<li>Support has been added for generating certificates and signatures in the PKIX API using SHA-3 based digests.</li>
<li>Further work has been done on improving SHA-3 performance.</li>
<li>The organizationIdentifier (2.5.4.97) attribute has been added to BCStyle.</li>
<li>GOST3412-2015 has been added to the JCE provider and the lightweight API.</li>
<li>The Blake2s message digest has been added to the provider and the lightweight API.</li>
<li>Unified Cofactor Diffie-Hellman (ECCDHU) is now supported for EC in the JCE and the lightweight API.</li>
<li>A DEROtherInfo generator for key agreement using NewHope as the source of the shared private info has been added that can be used in conjunction with regular key agreement algorithms.</li>
<li>RFC 7748: Added low-level implementations of X25519 and X448.</li>
</ul>
<h3>2.10.4 Security Related Changes and CVE's Addressed by this Release</h3>
<ul>
<li>CVE-2017-13098 ("ROBOT"), a Bleichenbacher oracle in TLS when RSA key exchange is negotiated. This potentially affected BCJSSE servers and any other TLS servers configured to use JCE for the underlying crypto - note the two TLS implementations using the BC lightweight APIs are not affected by this.</li>
</ul>

<h3>2.11.1 Version</h3>
Release: 1.58 <br/>
Date:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2017, August 18
<h3>2.11.2 Defects Fixed</h3>
<ul>
<li>NewHope and SPHINCS keys are now correctly created off certificates by the BC provider.</li>
<li>Use of the seeded constructor with SecureRandom() and the BC provider in first position could cause a stack overflow error. This has been fixed.</li>
<li>The boolean flag on ECDSAPublicKey in CVCertficate was hard coded. This has been fixed.</li>
<li>An edge condition in IV processing for GOFB mode has been found and fixed.</li>
<li>ANSSI named EC curves were not being recognised in PKCS#10 and certificate parsing. This has been fixed.</li>
<li>BaseStreamCipher.engineSetMode() could sometimes throw an IllegalArgumentException rather than a NoSuchAlgorithmException. This has been fixed.</li>
<li>Some class resolving used by the provider would fail if the BC jar was loaded on the boot class path. This has been fixed.</li>
<li>An off-by-one range check in SM2Signer has been fixed.</li>
<li>Retrieving an SM2 key from a certificate could result in a NullPointerException due to a problem with the curve lookup. This has been fixed.</li> 
<li>A race condition that could occur inside the HybridSecureRandom on reseed and result in an exception has been fixed.</li>
<li>DTLS now supports records containing multiple handshake messages.</li>
</ul>
<h3>2.11.3 Additional Features and Functionality</h3>
<ul>
<li>An implementation of GOST3410-2012 has been added to light weight API and the JCA provider.</li>
<li>Support for ECDH GOST3410-2012 and GOST3410-2001 have been added. The CMS API can also handle reading ECDH GOST3410 key transport messages.</li>
<li>Additional mappings have been added for a range of CVC-ECDSA algorithms.</li>
<li>XMMS and XMSSMT are now available via the BCPQC provider. Support has been added for using these keys in certificates as well.</li>
<li>Support has been added for DSTU-7564 message digest and the DSTU-7624 ciphers, together with their associated modes.</li>
<li>A new system property org.bouncycastle.asn1.allow_unsafe_integer has been added to allow parsing of malformed ASN.1 integers in a similar fashion to what BC 1.56 did. The default behavior remains as reject malformed integers.</li>
<li>SignedMailValidator would only pick up the first email address in a DN, even when there was more than one. This has been fixed.</li>
<li>PEMParser will now support a broader range of PBKDFs in encrypted private key files.</li>
<li>Work has been done on speeding up the SHA-3 family. The functions are now 3 to 4 times faster.</li>
<li>Some EC aliases in the provider had no corresponding implementations. These have been cleaned up.</li>
<li>TimeStampResponses now support definite-length encoding to allow the preservation of order in certificates sets for legacy responses.</li>
<li>The TSP API now supports SM2withSM3.</li>
<li>The BCJSSE provider now has a FIPS mode.</li>
<li>The BCJSSE provider now supports layered sockets.</li>
<li>The new TLS API now has protocol/API support for the status_request extension (OCSP stapling).</li>
<li>The new TLS API now supports RFC 7633 - X.509v3 TLS Feature Extension (e.g. "must staple"), enabled in default clients.</li>
<li>TLS exceptions have been made more directly informative.</li>
</ul>
<h3>2.11.4 Removed Features and Functionality</h3>
<ul>
<li>Per RFC 7465, removed support for RC4 in the new TLS API.</li>
<li>Per RFC 7568, removed support for SSLv3 in the new TLS API.</li>
</ul>

<h3>2.12.1 Version</h3>
Release: 1.57 <br/>
Date:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2017, May 11
<h3>2.12.2 Defects Fixed</h3>
<ul>
<li>A class cast exception for master certification removal in PGPPublicKey.removeCertification() by certification has been fixed.</li>
<li>GOST GOFB 28147-89 mode had an edge condition concerning the incorrect calculation of N4 (see section 6.1 of RFC 5830) affecting about 1% of IVs. This has been fixed.</li>
<li>The X.509 PolicyConstraints class was using implicit rather than explicit tagging for the SkipCerts field. This has been fixed.</li>
<li>Key expiration in the OpenPGP is now calculated for ambiguous self signatures using the most recently created self-signature, in line with GPG and the recommendation in RFC 4880.</li>
<li>Multiple validity periods in PGP keys were resolved in an adhoc fashion, in line with GPG's approach the PGP has been changed to return the most recent validity period signed.</li>
<li>An occasional class cast exception that could occur with nested multi-parts in the S/MIME API has been fixed.</li>
<li>A couple of bogus aliases associated AlgorithmParameters that did not resolve in the provider have been removed.</li>
<li>The CMS API will now correctly verify PSS signatures with odd length salts.</li>
<li>Choosing an invalid mode on a stream cipher in the JCE could result in an IllegalArgumentException. This has now been corrected to throw a NoSuchAlgorithmException.</li>
<li>Optional parameters for ECDSA public keys in CVCertificates were hard coded to non-optional. This has been fixed.</li>
<li>Passing a PKCS12 key to a Mac in the BC JCE always resulted in SHA-1 being used to process the password regardless of the underlying MAC algorithm. This has been fixed. An unrecognised HMAC will also now result in an exception.</li>
<li>The Base64 encoder now explicitly validates 2 character padding as being "==".</li>
<li>EC FixedPointCombMultiplier avoids 'infinity' point in lookup tables, reducing timing side-channels.</li>
<li>Reuse of a Blake2b digest with a call to reset() rather than doFinal() could result in incorrect padding being introduced and the wrong digest result produced. This has been fixed.</li>
</ul>
<h3>2.12.3 Additional Features and Functionality</h3>
<ul>
<li>ARIA (RFC 5794) is now supported by the provider and the lightweight API.</li>
<li>ARIA Key Wrapping (RFC 5649 style) is now supported by the provider and the lightweight API.</li>
<li>SM2 signatures, key exchange, and public key encryption has been added to the lightweight API.</li>
<li>XMSS has been added to the lightweight PQ API. Note: this should be treated as beta code.</li>
<li>API support for client side EST (RFC 7030), as well as some CMC (RFC 5273) has been added to the PKIX API. A full set of ASN.1 classes for both protocols has been added as well.</li>
<li>A test client for EST which will interop with the 7030 test server at http://testrfc7030.com/ has been added to the general test module in the current source tree.</li>
<li>The BCJSSE provider now supports SSLContext.getDefault(), with very similar behaviour to the SunJSSE provider, including checks of the relevant javax.net.ssl.* system properties and auto-loading of jssecacerts or cacerts as the default trust store.</li>
</ul>
<h3>2.12.4 Security Related Changes</h3>
<ul>
<li>The default parameter sizes for DH and DSA are now 2048. If you have been relying on key pair generation without passing in parameters generated keys will now be larger.</li>
<li>Further work has been done on preventing accidental re-use of a GCM cipher without first changing its key or iv.</li>
</ul>

<h3>2.13.1 Version</h3>
Release: 1.56 <br/>
Date:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2016, December 23
<h3>2.13.2 Defects Fixed</h3>
<ul>
<li>See section 2.1.4 for Security Defects.</li>
<li>Using unknown status with the ASN.1 CertStatus primitive could result in an IllegalArgumentException on construction. This has been fixed.</li>
<li>A potentional NullPointerException in a precomputation in WNafUtil has been removed.</li>
<li>PGPUtil.getDecoderStream() would throw something other than an IOException for empty and very small data. This has been fixed.</li>
</ul>
<h3>2.13.3 Additional Features and Functionality</h3>
<ul>
<li>Support for the explicit setting of AlgorithmParameters has been added to the JceCMSContentEncryptorBuilder and the JceCMSMacCaculatorBuilder classes to allow configuration of the session cipher/MAC used.</li>
<li>EC, ECGOST3410, and DSTU4145 Public keys are now validated on construction in the JCA/JCE and the light weight API.</li>
<li>DSA Public keys are now validated on construction in the JCA/JCE and the light weight API.</li>
<li>Diffie-Hellman public keys are now validated where parameters allow it.</li>
<li>Some validations are now applied to RSA moduli and public exponents.</li>
<li>The ASN.1 Object Identifier cache now uses a Concurrent HashMap for additional speed.</li>
<li>AES-CCM MAC support has been added to the provider.</li>
<li>Support for ChaCha7539 (ChaCha20 as defined in RFC 7539) and Poly1305 have been added to the provider.</li>
<li>Support has been added for defining your own curves and making them available to the key generators and factories.</li>
<li>Methods have been added for specifying that a PGPPublicKey/PGPPublicKeyRing is being encoded for export and trust packets are not required.</li>
<li>Plain-ECDSA and SHA-3 support has been added to DefaultDigestAlgorithmIdentifierFinder.</li>
<li>SHA-3 support has been added to BcDefaultDigestProvider.</li>
<li>A higher level TLS API and JSSE provider have been added to the project.</li>
</ul>
<h3>2.13.4 Security Related Changes and CVE's Addressed by this Release</h3>
<ul>
<li>It is now possible to configure the provider to only import keys for specific named curves.</li>
<li>Work has been done to improve the "constant time" behaviour of the RSA padding mechanisms.</li>
<li>The GCM ciphers in the JCE and lightweight API will now fail if an attempt is made to use them for encryption after a doFinal or without changing the IV.</li>
<li>The constructor for IESParameterSpec that allows the use of cipher without a nonce has been deleted. See also details for CVE-2016-1000344, CVE-2016-1000352.</li>
<li>Strict encoding enforcement has been introduced for ASN1Integer.</li>
<li>CVE-2016-1000338: DSA does not fully validate ASN.1 encoding of signature on verification. It is possible to inject extra elements in the sequence making up the signature and still have it validate, which in some cases may allow the introduction of "invisible" data into a signed structure.</li>
<li>CVE-2016-1000339: AESFastEngine has a side channel leak if table accesses can be observed. The use of lookup large static lookup tables in AESFastEngine means that where data accesses by the CPU can be observed, it is possible to gain information about the key used to initialize the cipher. We now recommend not using AESFastEngine where this might be a concern. The BC provider is now using AESEngine by default.</li>
<li>CVE-2016-1000340: Static ECDH vulnerable to carry propagation bug.
Carry propagation bugs in the implementation of squaring for several raw math classes have been fixed (org.bouncycastle.math.raw.Nat???). These classes are used by our custom elliptic curve implementations (org.bouncycastle.math.ec.custom.**), so there was the possibility of rare (in general usage) spurious calculations for elliptic curve scalar multiplications. Such errors would have been detected with high probability by the output validation for our scalar multipliers.</li>
<li>CVE-2016-1000341: DSA signature generation vulnerable to timing attack. Where timings can be closely observed for the generation of signatures, the lack of blinding in 1.55 or earlier, may allow an attacker to gain information about the signatures k value and ultimately the private value as well.</li>
<li>CVE-2016-1000342: ECDSA does not fully validate ASN.1 encoding of signature on verification. It is possible to inject extra elements in the sequence making up the signature and still have it validate, which in some cases may allow the introduction of "invisible" data into a signed structure.</li>
<li>CVE-2016-1000343: DSA key pair generator generates a weak private key if used with default values. If the JCA key pair generator is not explicitly initialised with DSA parameters, 1.55 and earlier generates a private value assuming a 1024 bit key size. In earlier releases this can be dealt with by explicitly passing parameters to the key pair generator.</li>
<li>CVE-2016-1000344: DHIES allows the use of unsafe ECB mode. This algorithm is now removed from the provider.</li>
<li>CVE-2016-1000345: DHIES/ECIES CBC mode vulnerable to padding oracle attack. For BC 1.55 and older, in an environment where timings can be easily observed, it is possible with enough observations to identify when the decryption is failing due to padding.</li>
<li>CVE-2016-1000346: Other party DH public key not fully validated. This can cause issues as invalid keys can be used to reveal details about the other party's private key where static Diffie-Hellman is in use. As of this release the key parameters are checked on agreement calculation.</li>
<li>CVE-2016-1000352: ECIES allows the use of unsafe ECB mode. This algorithm is now removed from the provider.</li>
</ul>
</ul>
<h3>2.13.5 Security Advisory</h3>
<ul>
<li>We consider the carry propagation bugs fixed in this release to have been exploitable in previous releases (1.51-1.55), for static ECDH, to reveal the long-term key, per <a href="https://eprint.iacr.org/2011/633">"Practical realisation and elimination of an ECC-related software bug attack", Brumley et.al.</a>. The most common case of this would be the non-ephemeral ECDH ciphersuites in TLS. These are not enabled by default in our TLS implementations, but they can be enabled explicitly by users. We recommend that users DO NOT enable static ECDH ciphersuites for TLS.</li>
</ul>

<h3>2.14.1 Version</h3>
Release: 1.55 <br/>
Date:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2016, August 18
<h3>2.14.2 Defects Fixed</h3>
<ul>
<li>Issues with cloning of blake digests with salts and personalisation strings have been fixed.</li>
<li>The JceAsymmetricValueDecryptor in the CRMF package now attempts to recognise a wider range of parameters for the key wrapping algorithm, rather than relying on a default.</li>
<li>GCM now fails if an attempt is made to go past 2^32-1 blocks.</li>
<li>(r, k) ordering for Poly1305 has been modified to be brought into line with RFC 7539.</li>
<li>An occasional error in Poly1305 due to sign-extension has been fixed.</li>
<li>TimeStampRequest was always failing to validate if extensions were present. This has been fixed.</li>
<li>ECIES/IES algorithm parameters encoding failed on default parameters. This has been fixed.</li>
<li>PGPObjectFactory.iterator() could fail when called on data with multiple stream packets. This has been fixed.</li>
<li>The McEliece implementation in the BCPQC provider has been revised and now has working key factories associated with it.</li>
<li>The X.509 UserNotice class can now cope with empty sequences.</li>
<li>Creation of multiple providers concurrently could cause issues with a non-synchronized Map in the provider. Code is now synchronized.</li>
<li>If the lightweight OAEP encoder is fed oversized input it will now throw something more informative than an ArrayOutOfBoundsException or simply truncate.</li>
<li>Attempting to use the PasswordRecipientInfoGenerator without explicitly setting the salt would cause a NullPointerException. This has been fixed.</li>
<li>The BasicConstraintsValidation in the CertPath API would throw a NullPointerException on an unconstrained path length. This has been fixed.</li>
<li>A shift error for > 24 bit numbers in TlsUtils has been fixed.</li>
<li>OAEP encryption for a zero length message would create invalid cipher text. This has been fixed.</li>
<li>Trying to use of non-default parameters for OAEP in CRMF would resort to the default parameter set. This has been fixed.</li>
<li>If the BC provider was not registered, creating a CertificateFactory would cause a new provider object to be created. This has been fixed.</li>
</ul>
<h3>2.14.3 Additional Features and Functionality</h3>
<ul>
<li>The DANE API has been updated to reflect the latest standard changes.</li>
<li>The signature algorithm SPHINCS-256 has been added to the post-quantum provider (BCPQC). Support is in place for SHA-512 and SHA3-512 (using trees based around SHA512_256 and SHA3_256 respectively).</li>
<li>The key exchange algorithm NewHope has been added to the post-quantum provider (BCPQC). Support is in place for the regular configuration using SHA3-256 as the flattening algorithm for the agreed value.</li>
<li>The CMS password recipient generator now allows the PRF to be changed to something other than SHA-1</li>
<li>Direct support for the SignatureTarget packet has been added to the OpenPGP API.</li>
<li>TLS: support for ClientHello Padding Extension (RFC 7685).</li>
<li>TLS: support for ECDH_anon key exchange.</li>
<li>Support has been added for HMAC SHA-3. Aliases have been added for NIST OIDs for SHA-3 HMAC as well.</li>
<li>Support has been added for SHA-3 in DSA, ECDSA, DDSA, and ECDDSA. Aliases have been added for NIST OIDs for DSA and ECDSA as well.</li>
<li>Support has been added for SHA-3 with RSA PKCS 1.5, PSS, and OAEP.</li>
<li>Support has been added for GOST R 34.11-2012 to the provider and the lightweight API.</li>
<li>PGP armored output can now be generated without a version string.</li>
<li>The TimeStampTokenGenerator will now generate timestamps down to a millisecond resolution.</li>
<li>Additional search methods have been added to PGP public and secret key rings.</li>
</ul>

<h3>2.15.1 Version</h3>
Release: 1.54 <br/>
Date:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2015, December 29
<h3>2.15.2 Defects Fixed</h3>
<ul>
<li>Blake2b-160, Blake2b-256, Blake2b-384, and Blake2b-512 are now actually in the provider and an issue with cloning Blake2b digests has been fixed.</li>
<li>PKCS#5 Scheme 2 using DESede CBC is now supported by the PKCS#12 implementation.</li>
<li>The IES engine would sometimes throw a "too short" exception on small messages which were the right length. This has been fixed.</li>
<li>Cipher.getOutputSize() for IES ciphers would throw a ClassCastException. This has been fixed.</li>
<li>It turns out, after advice one way and another that the NESSIE test vectors for Serpent are now what should be followed and that the vectors in the AES submission are regarded as an algorithm called Tnepres. The Serpent version now follows the NESSIE vectors, and the Tnepres cipher has been added to the provider and the lightweight API for compatibility.</li>
<li>Problems with DTLS record-layer version handling were resolved, making version negotiation work properly.
</ul>
<h3>2.15.3 Additional Features and Functionality</h3>
<ul>
<li>Camellia and SEED key wrapping are now supported for CMS key agreement</li>
<li>The BC TLS/DTLS code now includes a non-blocking API.</li>
<li>CTR/SIC mode now support an internal counter. The internal counter can be turned on by passing an IV smaller than the block size of the cipher's algorithm.</li>
<li>The lightweight CMS API operators now support CAST5 and RC2 CBC encryption.</li>
<li>The CMS API now supports Diffie-Hellman as specified in RFC 3370.</li>
<li>Support has been added to the CMS API for PKCS#7 ANY type encapsulated content where the encapsulated content is not an OCTET STRING.</li>
<li>PSSSigner in the lightweight API now supports fixed salts.</li>
</ul>
<h3>2.15.4 Security Advisory</h3>
<ul>
<li>(D)TLS 1.2: Motivated by <a href="https://www.google.com/search?q=CVE-2015-7575">CVE-2015-7575</a>, we have added validation that the signature algorithm received in DigitallySigned structures is actually one of those offered (in signature_algorithms extension or CertificateRequest). With our default TLS configuration, we do not believe there is an exploitable vulnerability in any earlier releases. Users that are customizing the signature_algorithms extension, or running a server supporting client authentication, are advised to double-check that they are not offering any signature algorithms involving MD5.</li>
</ul>
<h3>2.15.5 Notes</h3>
<p>
If you have been using Serpent, you will need to either change to Tnepres, or take into account the fact that Serpent is now byte-swapped compared to what it was before.
</p>

<h3>2.16.1 Version</h3>
Release: 1.53 <br/>
Date:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2015, October 10
<h3>2.16.2 Defects Fixed</h3>
<ul>
<li>The BC JCE cipher implementations could sometimes fail when used in conjunction with the JSSE and NIO. This has been fixed.</li>
<li>PGPPublicKey.getBitStrength() always returned 0 for EC keys. This has been fixed.</li>
<li>A PKCS12 key store containing a looping certificate chain could cause an OutOfMemoryException. This has been fixed.</li>
<li>A change in JDK 1.8 meant that X509Certificate.verify(PublicKey, Provider) would cause a stack overflow. This has been fixed.</li>
<li>Nested multiparts with irregular post-amble could cause verification issues for the SMIMESigned classes. This has been fixed.</li>
<li>CMSSignedData now supports verification of signed attributes where the calculated digest uses a different algorithm from the digest used in the signature.</li>
<li>TRUSTED CERTIFICATE parsing in PEM files was ignoring the attribute block. A new class X509TrustedCertificateBlock is now returned containing both the certificate and the trust information.</li>
<li>Adding a password to a PGP key which did not previously have one would result in an improperly formatted key. This has been fixed.</li>
<li>ECIES/IES was only using a 4 byte label length for the MAC tag when it should have been an 8 byte one. This has now been fixed and OldECIES/OldIES has been added for backwards compatibility.</li>
<li>The JceCRMFEncryptorBuilder was not recognising key size specific object identifiers properly. This has been fixed.</li>
<li>The OpenPGP ClearSignedFileProcessor would not handle verification of single line files properly. This has been fixed.</li>
<li>The BC X509Certificate class was no longer in agreement with the standard class for hashCode(). The BC X509Certificate class will now track the changes made in the standard Java distribution.</li>
<li>PGP signature hashed sub-packets with long length encodings would fail to validate on signature checking. This has been fixed.</li>
<li>The S/MIME API would occasionally leak InputStreams which could cause issues with custom DataSource implementations. This has been fixed.</li>
<li>The PKCS#12 KeyStore implementation would sometimes leave orphaned chain certificates in the key store after private key deletion. This has been fixed.</li>
<li>A bug in the DirectKeySignature OpenPGP example which could lead to extra data appearing in the signature has been fixed.</li>
<li>Explicit configuration of a BcAsymmetricKeyWrapper with a SecureRandom was not properly propagated internally. This has been fixed.</li>
<li>A CRL with a null certificate issuer would sometimes result in a NullPointerException during CertPathProcessing. This has been fixed.</li>
<li>The CertPath processor would occasionally fail to match a DistributionPoint name correctly. This has been fixed.</li>
<li>In order to avoid confusion about thread safety, BCrypt now uses a new instance for hash calculation every time it is invoked.</li>
<li>Some decidedly odd argument casting in the PKIXCertPathValidator has been fixed to throw an InvalidAlgorithmParameterException.</li>
<li>Presenting an empty array of certificates to the PKIXCertPathValidator would cause an IndexOutOfRangeException instead of a CertPathValidatorException. This has been fixed.</li>
</ul>
<h3>2.16.3 Additional Features and Functionality</h3>
<ul>
<li>It is now possible to specify that an unwrapped key must be usable by a software provider in the asymmetric unwrappers for CMS.</li>
<li>A Blake2b implementation has been added to the provider and lightweight API.</li>
<li>SHA3 has now been added to the provider and the lightweight API. SHAKE128 and SHAKE256 have also been added to the lightweight API. The original implementation of the draft standard has been renamed to Keccak.</li>
<li>The CMS API now supports RFC 6211 for both SignedData and AuthenticatedData.</li>
<li>The ASN.1 parser for ECGOST private keys will now parse keys encoded with a private value represented as an ASN.1 INTEGER.</li>
<li>EAX mode and CMAC is now supported for ciphers such as SHACAL-2 and Threefish.</li>
<li>The SM4 block cipher has been added to the provider and the lightweight API.</li>
<li>X9.31, ISO9796/2, and PSS signature support has been added for SHA512/224, SHA512/256.</li>
<li>SubjectPublicKeyInfoFactory now supports DSA parameters.</li>
<li>A range of new algorithms are now support for EC key agreement.</li>
<li>EC ContentSigners and EC ContentVerifiers have been added to the lightweight operator package in the PKIX APIs.</li>
<li>The PKCS#12 key store will now garbage collect orphaned certificates on saving.</li>
<li>Caching for ASN.1 ObjectIdentifiers has been rewritten to make use of an intern method. The "usual suspects" are now interned automatically, and the cache is used by the parser. Other OIDs can be added to the cache by calling ASN1ObjectIdentifier.intern().</li>
</ul>
<h3>2.16.4 Notes</h3>
<p>
It turns out there was a similar, but different, issue in Crypto++ to the BC issue with ECIES. Crypto++ 6.0 now offers a corrected version of ECIES which is compatible with that which is now in BC.
</p>

<h3>2.17.1 Version</h3>
Release: 1.52<br/>
Date:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2015, March 2
<h3>2.17.2 Defects Fixed</h3>
<ul>
<li>GenericSigner in the lightweight API would fail if the digest started with a zero byte, occasionally causing a TLS negotiation to fail. This has been fixed.</li>
<li>Some BC internal classes expected the BC provider to be accessible within the provider. This has been fixed.</li>
<li>Email based policy constraints in CertPath validation did not include '@'domain.name as a possible match. This has been fixed.</li>
<li>The Shacal2Engine would throw an ArrayIndexOutOfBoundsException if presented with input longer than a block size. This has been fixed.</li>
<li>Using PKCS5/PKCS7 with pad values greater than 127 would result in an exception on decryption. This has been fixed.</li>
<li>EC private key values could encode to an OCTET STRING which was shorter than that described in RFC 5915/SEC 1. This has been fixed.</li>
<li>Providing multiple trust anchors to the CertPath validator could cause a StackOverflowError on an invalid CertPath. This has been fixed.</li>
<li>TLS: bad-padding handling when encrypt-then-MAC enabled is now fixed.</li>
<li>ECDH KeyAgreement.init() was not properly honoring the JCE API in respect to non-null parameters. This has been fixed.</li>
<li>PKCS symmetric padding now takes into account pad lengths of more than 127 bytes.</li>
<li>Corrupted input to RFC5649WrapEngine could cause an out of memory error. This has been fixed.</li>
<li>OSGI import issues for bcmail have been fixed.</li>
<li>A badly formed issuer in a X.509 certificate could cause a null pointer exception in X509CertificateHolder.toString(). This has been fixed.</li>
<li>CMSSignedData.verifySignatures() could fail on a correct counter signature due to a mismatch of the SID. This has been fixed.</li>
</ul>
<h3>2.17.3 Additional Features and Functionality</h3>
<ul>
<li>The CMP support class CMPCertificate restricted the types of certificates that could be added. A more flexible method has been introduced to allow for other certificate types.</li>
<li>Support classes have be added for DNS-based Authentication of Named Entities (DANE) to the PKIX distribution.</li>
<li>Work has been done to reduce computation requirements for long skips associated with implementations of the SkippingCipher interface.</li>
<li>AES GCM mode is now supported by CMS EnvelopedData.</li>
<li>Iteration count is now settable in BcPKCS12MacCalculatorBuilder.</li>
<li>Support for BCrypt and it's OpenBSD variant has been added to the lightweight API.</li>
<li>It's now possible to specify the direction of the underlying cipher used for key wrapping with NIST/RFC3394 wrappers.</li>
<li>TLS: server-side support for DHE key exchange.</li>
<li>TLS: server-side support for PSK and SRP ciphersuites.</li>
<li>TLS: (EC)DSA now supports signatures with non-SHA1 digests.</li>
<li>TLS: support for ECDHE_ECDSA/AES/CCM ciphersuites from RFC 7251.</li>
<li>Cipher.getIV() now returns nonces for AEAD modes.</li>
<li>OIDs for dhPublicNumber and dhKeyAgreement are now supported by the provider.</li>
<li>OIDs for several signature types using the RIPEMD family of digests have been added to the provider.</li>
<li>JcaJceUtils.getDigestAlgName() has been added to assist in converting OIDs representing message digests into JCA algorithm names.</li>
<li>BasicOCSPResp.getSignatureAlgorithmID() has been added to allow algorithm indentifier details to be returned from a basic OCSP response.</li>
<li>Additional OIDs have been added for OCSP.</li>
<li>X509CRLObject.getSignAlgName() now attempts to return an actual name, rather than an OID for, for the signature algorithm.</li>
<li>SignedMailValidator now pays attention to the date in the PKIXParameters object if it is set.</li>
<li>A missing signing time in a signature no longer causes SignedMailValidator to fail a signature, but provide a warning instead.</li>
<li>An AlgorithmNameFinder implementation has been added to the PKIX API to provide "human friendly" translations of algorithm OIDs.</li>
<li>Support has been added for X9.31-1998 DRBG and X9.31-1998 RSA signatures to the lightweight API and the provider.</li>
<li>CertPath validator will now make use of the issuer key identifier and the issuer name if a key identifier is available for the issuer.</li>
<li>Support for some JDK1.5+ language features has finally made its way into the repository.</li>
</ul>
<h3>2.17.4 Security Advisory</h3>
<ul>
<li>The CTR DRBGs would not populate some bytes in the requested block of random bytes if the size of the block requested was not an exact multiple of the block size of the underlying cipher being used in the DRBG. If you are using the CTR DRBGs with "odd" keysizes, we strongly advise upgrading to this release, or contacting us for a work around.</li>
</ul>

<h3>2.18.1 Version</h3>
Release: 1.51<br />
Date:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2014, July 28
<h3>2.18.2 Defects Fixed</h3>
<ul>
<li>The AEAD GCM AlgorithmParameters object was unable to return a GCMParameterSpec object. This has been fixed.</li>
<li>Cipher.getIV() was returning null for AEAD mode ciphers. This has been fixed.</li>
<li>CipherInputStream would fail for some AEAD mode ciphers if the message was over 4k in length. This has been fixed.</li>
<li>The JCE provider will now produce simple RSAPrivateKey objects where CRT coefficients are not provided.</li>
<li>PGP key signature certifications did not support DIRECT KEY signatures. This has been fixed.</li>
<li>User Attribute subpackets in PGP with long length encodings could result in certification verification failing. This has been fixed.</li>
<li>Calls to  CommandMap.setDefaultCommandMap() in the SMIME API are now wrapped in doPrivileged() blocks to allow them to work with a security manager.</li>
<li>The encoding of the certificate_authorities field of a TLS CertificateRequest has been fixed.</li>
<li>EC point formats are now strictly enforced in the TLS API.</li>
<li>The provider implementation was failing to throw an exception if algorithm parameters were passed in when none were required for EC key agreement. This has been fixed.</li>
<li>PKCS#12 files containing keys/certificates with empty attribute sets attached to them no longer cause an ArrayIndexOutOfBoundsException to be thrown.</li>
<li>Issues with certificate verification and server side DTLS/TLS 1.2 have now been fixed.</li>
</ul>
<h3>2.18.3 Additional Features and Functionality</h3>
<ul>
<li>The range of key algorithm names that will be interpreted by KeyAgreement.generateSecret() has been expanded for ECDH derived algorithms in the provider. A KeyAgreement of ECDHwithSHA1KDF can now be explicitly created.</li>
<li>ECIES now supports the use of IVs with the underlying block cipher and CBC mode in both the lightweight and the JCE APIs.</li>
<li>Support has been add for RFC5649 key wrapping using AES.</li>
<li>The PGP API now allows access and handling of User IDs as raw byte arrays, to deal with keyrings not using UTF-8.</li>
<li>The PGP API now provides automatic conversion of embedded signatures in signature sub-packet vectors.</li>
<li>The PGP API now fully supports ECDH as outlined in RFC 6637.</li>
<li>GCM and GMAC now support tag lengths down to 32 bits.</li>
<li>Custom implementations for many of the SEC Fp curves have been added, resulting in drastically improved performance. The current list includes all secp***k1 and secp***r1 curves from 192 to 521 bits. They can be accessed via the org.bouncycastle.crypto.ec.CustomNamedCurves class and are generally selected by other internal APIs in place of the generic implementations.</li>
<li>Automatic EC point validation added, both for decoded inputs and multiplier outputs.</li>
<li>A SkippingCipher interface has been added for ciphers that can be moved into a specific state for a given byte address. The lightweight class StreamBlockCipher has been generalised to support any BlockCipher object that can support a streaming mode.</li>
<li>ASN.1 date/time objects now support the passing in of a Locale to allow for constructing the object using a Date interpreted from a different locale to the default for the JVM.</li>
<li>The range of Diffie-Hellman OIDs recognised by the provider has been extended.</li>
<li>Some utility methods for interpreting OIDs have been exposed in the JcaJceUtils class.</li>
<li>A method has been added to CMSSignedData for replacing the OCSP responses associated with a signed message.</li>
<li>Use of RC2/RC4 in the CMS is now provider independent.</li>
<li>TlsInputStream now provides a means of supporting InputStream.available().</li>
<li>Dependencies on the JCA have been removed from PGPObjectFactory.</li>
<li>Further work has been done on improving key quality with EC and DSA algorithms.</li>
<li>KDFCounterBytesGenerator now supports suffix and prefix fixed input data, as outlined in NIST SP 800-108.</li>
<li>Support has been added to allow retrieval and resetting the internal state of the SHA/SHA-2 digests in the lightweight API using an encoded format.</li>
<li>BSI plain ECDSA is now supported by the provider.</li>
<li>The provider now advertises RSA PSS signature implementations directly using the standard naming.</li>
<li>Full support is now provided for client-side auth in the D/TLS server code.</li>
<li>Compatibility issues with some OSGI containers have been addressed.</li>
</ul>
<h3>2.18.4 Notes</h3>
<ul>
<li>Support for NTRUSigner has been deprecated as the algorithm has been withdrawn.</li>
<li>Some changes have affected the return values of some methods. If you are migrating from an earlier release, it is recommended to recompile before using this release.</li>
<li>There has been further clean out of deprecated methods in this release. If your code has previously been flagged as using a deprecated method you may need to change it. The OpenPGP API is the most heavily affected.</li>
</ul>
<h3>2.19.1 Version</h3>
Release: 1.50<br />
Date:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2013, December 3
<h3>2.19.2 Defects Fixed</h3>
<ul>
<li>The DualECSP800DRBG sometimes truncated the last block in the generated stream incorrectly. This has been fixed.</li>
<li>Keys produced from RSA certificates with specialised parameters would lose the parameter settings. This has been fixed.</li>
<li>OAEP parameters were being ignored on CMS key trans recipient processing. This has been fixed.</li>
<li>OpenPGP NotationData was restricting the name and value lengths to 255 characters and truncating silently. This has been fixed.</li>
<li>CTS mode is now in alignment with the errata for RFC 2040, as detailed in RFC 3962.</li>
<li>Occasionally the provider implementation of DH KeyAgreement would drop a leading zero byte off the start of the shared secret (see RFC 2631 2.1.2). This has been fixed.</li>
<li>RFC3394WrapEngine was ignoring the offset parameter inOff and using zero instead. This has been fixed.</li>
<li>GOST keys would not encode using the CryptoPro parameter set, even if it was available. This has been fixed.</li>
<li>The TimeStampRequest stream constructor was not setting the extensions field correctly. This has been fixed.</li>
<li>Default RC2 parameters for 40 bit RC2 keys in CMSEnvelopedData were encoding incorrectly. This has been fixed.</li>
<li>In case of a long hash the DSTU4145 implementation would sometimes remove one bit too much during truncation. This has been fixed.</li>
</ul>
<h3>2.19.3 Additional Features and Functionality</h3>
<ul>
<li>Additional work has been done on CMS recipient generation to simplify the generation of OAEP encrypted messages and allow for non-default parameters.</li>
<li>OCB implementation updated to account for changes in draft-irtf-cfrg-ocb-03.</li>
<li>RFC 6637 ECDSA and ECDH support has been added to the OpenPGP API.</li>
<li>Implementations of Threefish and Skein have been added to the provider and the lightweight API.</li>
<li>Implementations of the SM3 digest have been added to the provider and the lightweight API.</li>
<li>The 3 MAC based KDF generators in NIST SP 800-108 have been added to the lightweight API.</li>
<li>Support has been added for the GOST PKCS#5 PBKDF2 PBE function and handling of GOST PKCS#12 files.</li>
<li>Support has been added for the CryptoPro GOST CFB mode key meshing.</li>
<li>Implementations of XSalsa20 and ChaCha have been added. Support for reduced round Salas20 has been added.</li>
<li>Support has been added for RFC 6979 Determinstic DSA/ECDSA to the provider and the lightweight API.</li>
<li>Support for RC2 and RC4 in the CMS API has been generalised to work for other JCE providers.</li>
<li>Support for the Poly1305 MAC has been added to the lightweight API and the JCE Provider.</li>
<li>OpenSSL JcaPEMKeyConverter now supports OIDs for RSA and DSA as well as ECDSA.</li>
<li>A simplified certificate path API has been added to the PKIX package. It is not fully NIST compliant yet, however it does provide a range of basic validations without having to use the JCA.</li>
<li>Package version information is now included in the jar MANIFEST.MF.</li>
<li>The JDK 1.5+ provider will now recognise and use GCMParameterSpec if it is run in a 1.7 JVM.</li>
<li>Client side support and some server side support has been added for TLS/DTLS 1.2.</li>
</ul>
<h3>2.19.4 Notes</h3>
<ul>
<li>org.bouncycastle.crypto.DerivationFunction is now a base interface, the getDigest() method appears on DigestDerivationFunction.</li>
<li>Recent developments at NIST indicate the SHA-3 may be changed before final standardisation. Please bare this in mind if you are using it.</li>
<li>Other recent developments have raised concerns about the DualECDRBG. We have left the class in place for now, but it is now possible to provide your own parameter values, rather than using the NIST defined ones, if you choose to do so.</li>
<li>Most deprecated methods have been removed from the PKIX API.</li>
<li>As the IDEA patent has finally expired, IDEA is now supported by the standard provider.</li>
<li>ECDH support for OpenPGP should still be regarded as experimental. It is still possible there will be compliance issues with other implementations.</li>
</ul>

<h3>2.20.1 Version</h3>
Release: 1.49<br />
Date:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2013, May 31
<h3>2.20.2 Defects Fixed</h3>
<ul>
<li>Occasional ArrayOutOfBounds exception in DSTU-4145 signature generation has been fixed.</li>
<li>The handling of escaped characters in X500 names is much improved.</li>
<li>The BC CertificateFactory no longer returns null for CertificateFactory.getCertPathEncodings().</li>
<li>PKCS10CertificationRequestBuilder now encodes no attributes as empty by default. Encoding as absent is still available via a boolean flag.</li>
<li>DERT61String has been reverted back to its previous implementation. A new class DERT61UTF8String has been introduced which defaults to UTF-8 encoding.</li>
<li>OAEPEncoding could throw an array output bounds exception for small keys with large mask function digests. This has been fixed.</li>
<li>PEMParser would throw a NullPointerException if it ran into explicit EC curve parameters, it would also throw an Exception if the named curve was not already defined. The parser now returns X9ECParmameters for explicit parameters and returns an ASN1ObjectIdentifier for a named curve.</li>
<li>The V2TBSCertListGenerator was adding the wrong date type for CRL invalidity date extensions. This has been fixed.</li>
</ul>
<h3>2.20.3 Additional Features and Functionality</h3>
<ul>
<li>A SecretKeyFactory has been added that enables use of PBKDF2WithHmacSHA.</li>
<li>Support has been added to PKCS12 KeyStores and PfxPdu to handle PKCS#5 encrypted private keys.</li>
<li>Support has been added for SHA-512/224, SHA-512/256, as well as a general SHA-512/t in the lightweight API.</li>
<li>The JcaPGPPrivateKey class has been added to provide better support in the PGP API for HSM private keys.</li>
<li>A new KeyStore type, BKS-V1, has been added for people needing to create key stores compatible with earlier versions of Bouncy Castle.</li>
<li>Some extra generation methods have been added to TimeStampResponseGenerator to allow more control in the generation of TimeStampResponses.</li>
<li>It is now possible to override the SignerInfo attributes during TimeStampTokenGeneration.</li>
<li>The TSP API now supports generation of certIDs based on digests other than SHA-1.</li>
<li>OCSP responses can now be included in CMS SignedData objects.</li>
<li>The SipHash MAC algorithm has been added to the lightweight API and the provider.</li>
<li>ISO9796-2 PSS signatures can now be initialised with a signature to allow the signer to deal with odd recovered message lengths on verification.</li>
<li>The 4 DRBGs described in NIST SP 800-90A have been added to the prng package together with SecureRandom builders.</li>
<li>Support has been added for OCB mode in the lightweight API.</li>
<li>DSA version 2 parameter and key generation is now supported in the provider and lightweight API.</li>
<li>A new interface Memoable has been added for objects that can copy in and out their state. The digest classes now support this. A special
class NonMemoableDigest has been added which hides the Memoable interface where it should not be available.</li>
<li>TDEA is now recognised as an alias for DESede.</li>
<li>A new package org.bouncycastle.crypto.ec has been introduced to the light wieght API with a range of EC based cryptographic operators.</li>
<li>The OpenPGP API now supports password changing on V3 keys if the appropriate PBEKeyEncryptor is used.</li>
<li>The OpenPGP API now supports password changing on secret key rings where only the private keys for the subkeys have been exported.</li>
<li>Support has been added to the lightweight API for RSA-KEM and ECIES-KEM.</li>
<li>Support has been added for NIST SP 800-38D - GMAC to AES and other 128 bit block size algorithms.</li>
<li>The org.bouncycastle.crypto.tls package has been extended to support client and server side TLS 1.1.</li>
<li>The org.bouncycastle.crypto.tls package has been extended to support client and server side DTLS 1.0.</li>
<li>A basic commitment package has been introduced into the lightweight API containing a digest based commitment scheme.</li>
<li>It is now possible to set the NotAfter and NotBefore date in the CRMF CertificateRequestMessageBuilder class.</li>
</ul>
<h3>2.20.4 Notes</h3>
<ul>
<li>The NTRU implementation has been moved into the org.bouncycastle.pqc package hierarchy.</li>
<li>The change to PEMParser to support explicit EC curves is not backward compatible. If you run into a named curve you need to use org.bouncycastle.asn1.x9.ECNamedCurveTable.getByOID() to look the curve up if required.</li>
</ul>

<h3>2.21.1 Version</h3>
Release: 1.48<br />
Date:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2013, February 10
<h3>2.21.2 Defects Fixed</h3>
<ul>
<li>Occasional key compatibility issues in IES due to variable length keys have been fixed.</li>
<li>PEMWriter now recognises the new PKCS10CertificationRequest object.</li>
<li>The provider implementation for RSA now resets when the init method is called.</li>
<li>SignerInformation has been rewritten to better support signers without any associated signed attributes.</li>
<li>An issue with an incorrect version number of SignedData associated with the use of SubjectKeyIdentifiers has now been fixed.</li>
<li>An issue with the equals() check in BCStrictStyle has been fixed.</li>
<li>The BC SSL implementation has been modified to deal with the "Lucky Thirteen" attack.</li>
<li>A regression in 1.47 which prevented key wrapping with regular symmetric PBE algorihtms has been fixed.</li>
</ul>

<h3>2.21.3 Additional Features and Functionality</h3>
<ul>
<li>IES now supports auto generation of ephemeral keys in both the JCE and the lightweight APIs.</li>
<li>A new class PEMParser has been added to return the new CertificateHolder and Request objects introduced recently.</li>
<li>An implementation of Password Authenticated Key Exchange by Juggling (J-PAKE) has now been added to the lightweight API.</li>
<li>Support has now been added for the DSTU-4145-2002 to the lightweight API and the provider.</li>
<li>The BC X509Certificate implementation now provides support for the JCA methods X509Certificate.getSubjectAlternativeNames() and X509Certificate.getIssuerAlternativeNames().</li>
<li>PEMReader can now be configured to support different providers for encyrption and public key decoding.</li>
<li>Some extra DSA OIDs have been added to the supported list for the provider.</li>
<li>The BC provider will now automatically try to interpret other provider software EC private keys. It is no longer necessary to use a KeyFactory for conversion.</li>
<li>A new provider, the BCPQ (for BC Post Quantum) provider has been added with support for the Rainbow signature algorithm and the McEliece family of encryption algorithms.</li>
<li>Support has been added for the SHA3 family of digests to both the provider and the lightweight API.</li>
<li>T61String now uses UTF-8 encoding by default rather than a simple 8 bit transform.</li>
</ul>

<h3>2.22.1 Version</h3>
Release: 1.47<br/>
Date:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2012, March 30
<h3>2.22.2 Defects Fixed</h3>
<ul>
<li>OpenPGP ID based certifications now support UTF-8. Note: this may mean that some old certifications no longer validate - if this happens a retry can be added using by converting the ID using Strings.fromByteArray(Strings.toByteArray(id)) - this will strip out the top byte in each character.</li>
<li>IPv4/IPv6 parsing in CIDR no longer assumes octet boundaries on a mask.</li>
<li>The CRL PKIX routines will now only rebuild the CRL as a last resort when looking for the certificate issuer.</li>
<li>The DEK-Info header in PEM generation was lower case. It is now upper case in accordance with RFC 1421.</li>
<li>An occasional issue causing an OutOfMemoryException for PGP compressed data generation has now been fixed.</li>
<li>An illegal argument exception that could occur with multi-valued RDNs in the X509v3CertificateBuilder has been fixed.</li>
<li>Shared secret calculation in IES could occasionally add a leading zero byte. This has been fixed.</li>
<li>PEMReader would choke on a private key with an empty password. This has been fixed.</li>
<li>The default MAC for a BKS key store was 2 bytes, this has been upgraded to 20 bytes. This fix is now also referred to in CVE-2018-5382.</li>
<li>BKS key store loading no longer freezes on negative iteration counts.</li>
<li>A regression in 1.46 which prevented parsing of PEM files with extra text at the start has been fixed.</li>
<li>CMS secret key generation now attempts to stop use of invalid lengths with OIDs that predefine a key length.</li>
<li>Check of DH parameter L could reject some valid keys. This is now fixed.</li>
</ul>

<h3>2.22.3 Additional Features and Functionality</h3>
<ul>
<li>Support is now provided via the RepeatedKey class to enable IV only re-initialisation in the JCE layer. The same effect can be acheived in the light weight API by using null as the key parameter when creating a ParametersWithIV object.</li>
<li>CRMF now supports empty poposkInput.</li>
<li>The OpenPGP API now supports operator based interfaces for most operations and lightweight implementations have been added for JCE related functionality.</li>
<li>JcaSignerId and JceRecipientId will now match on serial number, issuer, and the subject key identifier if it's available.</li>
<li>CMS Enveloped and AuthenticatedData now support OriginatorInfo.</li>
<li>NTRU encryption and signing is now provided in the lightweight source and the ext version of the provider.</li>
<li>There is now API support for Extended Access Control (EAC).</li>
<li>The performance of CertPath building and validation has been improved.</li>
<li>The TLS Java Client API has been updated to make support for GSI GSSAPI possible.</li>
<li>Support for ECDSA_fixed_ECDH authentication has been added to the TLS client.</li>
<li>Support for the Features signature sub-packet has been added to the PGP API.</li>
<li>The number of lightweight operators for PGP and CMS/SMIME has been increased.</li>
<li>Classes involved in CRL manipulation have been rewritten to reduce memory requirements for handling and parsing extremely large CRLs.</li>
<li>RFC 5751 changed the definition of the micalg parameters defined in RFC 3851. The SMIMESignedGenerator is now up to date with the latest micalg parameter set and a constructor has been added to allow the old micalg parameter set to be used.</li>
<li>An operator based framework has been added for processing PKCS#8 and PKCS#12 files.</li>
<li>The J2ME lcrypto release now includes higher level classes for handling PKCS, CMS, CRMF, CMP, EAC, OpenPGP, and certificate generation.</li>
</ul>

<h3>2.22.4 Other notes</h3>
<p>
Okay, so we have had to do another release. The issue we have run into is that we probably didn't go far enough in 1.46, but we are now confident that moving from this release to 2.0 should be largely just getting rid of deprecated methods. While this release does change a lot it is relatively straight forward to do a port and we have a <a href="https://github.com/bcgit/bc-java/wiki/Porting-From-Earlier-BC-Releases-to-1.47-and-Later">porting guide</a> which explains the important ones. The area there has been the most change in is the ASN.1 library which was in bad need of a rewrite after 10 years of patching. On the bright side the rewrite did allow us to eliminate a few problems and bugs in the ASN.1 library, so we have some hope anyone porting to it will also have similar benefits. As with 1.46 the other point of emphasis has been making sure interface support is available for operations across the major APIs, so the lightweight API or some local role your own methods can be used instead for doing encryption and signing.
</p>

<h3>2.23.1 Version</h3>
Release: 1.46</br>
Date:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2011, February 23
<h3>2.23.2 Defects Fixed</h3>
<ul>
<li>An edge condition in ECDSA which could result in an invalid signature has been fixed.</li>
<li>Exhaustive testing has been performed on the ASN.1 parser, eliminating another potential OutOfMemoryException and several escaping run time exceptions.</li>
<li>BC generated certificates generated different hashCodes from other equivalent implementations. This has been fixed.</li>
<li>Parsing an ESSCertIDv2 would fail if the object did not include an IssuerSerialNumber. This has been fixed.</li>
<li>DERGeneralizedTime.getDate() would produce incorrect results for fractional seconds. This has been fixed.</li>
<li>PSSSigner would produce incorrect results if the MGF digest and content digest were not the same. This has been fixed.</li>
</ul>
<h3>2.23.3 Additional Features and Functionality</h3>
<ul>
<li>A null genTime can be passed to TimeStampResponseGenerator.generate() to generate timeNotAvailable error responses.</li>
<li>Support has been added for reading and writing of openssl PKCS#8 encrypted keys.</li>
<li>New streams have been added for supporting general creation of PEM data, and allowing for estimation of output size on generation. Generators have been added for some of the standard OpenSSL objects.</li>
<li>CRL searching for CertPath validation now supports the optional algorithm given in Section 6.3.3 of RFC 5280, allowing the latest CRL to be used for a set time providing the certificate is unexpired.</li>
<li>AES-CMAC and DESede-CMAC have been added to the JCE provider.</li>
<li>Support for CRMF (RFC 4211) and CMP (RFC 4210) has been added.</li>
<li>BufferedBlockCipher will now always reset after a doFinal().</li>
<li>Support for CMS TimeStampedData (RFC 5544) has been added.</li>
<li>JCE EC keypairs are now serialisable.</li>
<li>TLS now supports client-side authentication.</li>
<li>TLS now supports compression.</li>
<li>TLS now supports ECC cipher suites (RFC 4492).</li>
<li>PGP public subkeys can now be separately decoded and encoded.</li>
<li>An IV can now be passed to an ISO9797Alg3Mac.</li>
</ul>
<h3>2.23.4 Other notes</h3>
<p>
Baring security patches we expect 1.46 will be the last of the 1.* releases. The next release of
BC will be version 2.0. For this reason a lot of things in 1.46 that relate to CMS have been deprecated and
new methods have been added to the CMS and certificate handling APIs which provide greater flexibility
in how digest and signature algorithms get used. It is now possible to use the lightweight API or a simple
custom API with CMS and for certificate generation. In addition a lot of methods and some classes that were
deprecated for reasons of been confusing, or in some cases just plan wrong, have been removed. 
</p>
<p>
So there are four things useful to know about this release:
<ul>
<li>It's not a simple drop in like previous releases, if you wish migrate to it you will need to recompile your application.</li>
<li>If you avoid deprecated methods it should be relatively painless to move to version 2.0</li>
<li>The X509Name class will utlimately be replacde with the X500Name class, the getInstance() methods on both these classes allow conversion from one type to another.</li>
<li>The org.bouncycastle.cms.RecipientId class now has a collection of subclasses to allow for more specific recipient matching. If you are creating your own recipient ids you should use the constructors for the subclasses rather than relying on the set methods inherited from X509CertSelector. The dependencies on X509CertSelector and CertStore will be removed from the version 2 CMS API.</li>
</ul>
</p>
<h3>2.24.1 Version</h3>
Release: 1.45<br/>
Date:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2010, January 12
<h3>2.24.2 Defects Fixed</h3>
<ul>
<li>OpenPGP now supports UTF-8 in file names for literal data.</li>
<li>The ASN.1 library was losing track of the stream limit in a couple of places, leading to the potential of an OutOfMemoryError on a badly corrupted stream. This has been fixed.</li>
<li>The provider now uses a privileged block for initialisation.</li>
<li>JCE/JCA EC keys are now serialisable.</li>
</ul>
<h3>2.24.3 Additional Features and Functionality</h3>
<ul>
<li>Support for EC MQV has been added to the light weight API, provider, and the CMS/SMIME library.</li>
</ul>
<h3>2.24.4 Security Advisory</h3>
<ul>
<li>This version of the provider has been specifically reviewed to eliminate possible timing attacks on algorithms such as GCM and CCM mode.</li>
</ul>

<h3>2.24.1 Version</h3>
Release: 1.44<br/>
Date:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2009, October 9
<h3>2.24.2 Defects Fixed</h3>
<ul>
<li>The reset() method in BufferedAsymmetricBlockCipher is now fully clearing the buffer.</li>
<li>Use of ImplicitlyCA with KeyFactory and Sun keyspec no longer causes NullPointerException.</li>
<li>X509DefaultEntryConverter was not recognising telephone number as a PrintableString field. This has been fixed.</li>
<li>The SecureRandom in the J2ME was not using a common seed source, which made cross seeeding of SecureRandom's impossible. This has been fixed.</li>
<li>Occasional uses of "private final" on methods were causing issues with some J2ME platforms. The use of "private final" on methods has been removed.</li>
<li>NONEwithDSA was not resetting correctly on verify() or sign(). This has been fixed.</li>
<li>Fractional seconds in a GeneralisedTime were resulting in incorrect date conversions if more than 3 decimal places were included due to the Java date parser. Fractional seconds are now truncated to 3 decimal places on conversion.</li>
<li>The micAlg in S/MIME signed messages was not always including the hash algorithm for previous signers. This has been fixed.</li>
<li>SignedMailValidator was only including the From header and ignoring the Sender header in validating the email address. This has been fixed.</li>
<li>The PKCS#12 keystore would throw a NullPointerException if a null password was passed in. This has been fixed.</li>
<li>CertRepMessage.getResponse() was attempting to return the wrong underlying field in the structure. This has been fixed.</li>
<li>PKIXCertPathReviewer.getTrustAnchor() could occasionally cause a null pointer exception or an exception due to conflicting trust anchors. This has been fixed.</li>
<li>Handling of explicit CommandMap objects with the generation of S/MIME messages has been improved.</li>
</ul>
<h3>2.24.3 Additional Features and Functionality</h3>
<ul>
<li>PEMReader/PEMWriter now support encrypted EC keys.</li>
<li>BC generated EC private keys now include optional fields required by OpenSSL.</li>
<li>Support for PSS signatures has been added to CMS and S/MIME.</li>
<li>CMS processing will attempt to recover if there is no AlgorithmParameters object for a provider and use an IvParameterSpec where possible.</li>
<li>CertificateID always required a provider to be explicitly set. A null provider is now interpreted as a request to use the default provider.</li>
<li>SubjectKeyIdentifier now supports both methods specified in RFC 3280, section 4.2.1.2 for generating the identifier.</li>
<li>Performance of GCM mode has been greatly improved (on average 10x).</li>
<li>The BC provider has been updated to support the JSSE in providing ECDH.</li>
<li>Support for mac lengths of 96, 104, 112, and 120 bits has been added to existing support for 128 bits in GCMBlockCipher.</li>
<li>General work has been done on trying to propagate exception causes more effectively.</li>
<li>Support for loading GOST 34.10-2001 keys has been improved in the provider.</li>
<li>Support for raw signatures has been extended to RSA and RSA-PSS in the provider. RSA support can be used in CMSSignedDataStreamGenerator to support signatures without signed attributes.</li>
</ul>

<h3>2.25.1 Version</h3>
Release: 1.43<br/>
Date:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2009, April 13
<h3>2.25.2 Defects Fixed</h3>
<ul>
<li>Multiple countersignature attributes are now correctly collected.</li>
<li>Two bugs in HC-128 and HC-256 related to sign extension and byte swapping have been fixed. The implementations now pass the latest ecrypt vector tests.</li>
<li>X509Name.hashCode() is now consistent with equals.</li>
</ul>
<h3>2.25.3 Security Advisory</h3>
<ul>
<li>The effect of the sign extension bug was to decrease the key space the HC-128 and HC-256 ciphers were operating in and the byte swapping inverted every 32 bits of the generated stream. If you are using either HC-128 or HC-256 you must upgrade to this release.</li>
</ul>

<h3>2.26.1 Version</h3>
Release: 1.42<br/>
Date:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2009, March 16
<h3>2.26.2 Defects Fixed</h3>
<ul>
<li>A NullPointer exception which could be result from generating a diffie-hellman key has been fixed.</li>
<li>CertPath validation could occasionally mistakenly identify a delta CRL. This has been fixed.</li>
<li>'=' inside a X509Name/X509Principal was not being properly escaped. This has been fixed.</li>
<li>ApplicationSpecific ASN.1 tags are now recognised in BER data. The getObject() method now handles processing of arbitrary tags.</li>
<li>X509CertStoreSelector.getInstance() was not propagating the subjectAlternativeNames attribute. This has been fixed.</li>
<li>Use of the BC PKCS#12 implementation required the BC provider to be registered explicitly with the JCE. This has been fixed.</li>
<li>OpenPGP now fully supports use of the Provider object.</li>
<li>CMS now fully supports use of the Provider object.</li>
<li>Multiplication by negative powers of two is fixed in BigInteger.</li>
<li>OptionalValidity now encodes correctly.</li>
</ul>
<h3>2.26.3 Additional Features and Functionality</h3>
<ul>
<li>Support for NONEwithECDSA has been added.</li>
<li>Support for Grainv1 and Grain128 has been added.</li>
<li>Support for EAC algorithms has been added to CMS/SMIME.</li>
<li>Support for basic CMS AuthenticatedData to the CMS package.</li>
<li>Jars are now packaged using pack200 for JDK1.5 and JDK 1.6.</li>
<li>ASN1Dump now supports a verbose mode for displaying the contents of octet and bit strings.</li>
<li>Support for the SRP-6a protocol has been added to the lightweight API.</li>
</ul>

<h3>2.27.1 Version</h3>
Release: 1.41<br/>
Date:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2008, October 1
<h3>2.27.2 Defects Fixed</h3>
<ul>
<li>The GeneralName String constructor now supports IPv4 and IPv6 address parsing.</li>
<li>An issue with nested-multiparts with postamble for S/MIME that was causing signatures to fail verification has been fixed.</li>
<li>ESSCertIDv2 encoding now complies with RFC 5035.</li>
<li>ECDSA now computes correct signatures for oversized hashes when the order of the base point is not a multiple of 8 in compliance with X9.62-2005.</li>
<li>J2ME SecureRandom now provides additional protection against predictive and backtracking attacks when high volumes of random data are generated.</li>
<li>Fix to regression from 1.38: PKIXCertPathCheckers were not being called on intermediate certificates.</li>
<li>Standard name "DiffieHellman" is now supported in the provider.</li>
<li>Better support for equality tests for '#' encoded entries has been added to X509Name.</li>
</ul>
<h3>2.27.3 Additional Features and Functionality</h3>
<ul>
<li>Camellia is now 12.5% faster than previously.</li>
<li>A smaller version (around 8k compiled) of Camellia, CamelliaLightEngine has also been added.</li>
<li>CMSSignedData generation now supports SubjectKeyIdentifier as well as use of issuer/serial.</li>
<li>A CMSPBE key holder for UTF8 keys has been added to the CMS API.</li>
<li>Salt and iteration count can now be recovered from PasswordRecipientInformation.</li>
<li>Methods in the OpenPGP, CMS, and S/MIME APIs which previously could only take provider names can now take providers objects as well (JDK1.4 and greater).</li>
<li>Support for reading and extracting personalised certificates in PGP Secret Key rings has been added.</li>
</ul>

<h3>2.28.1 Version</h3>
Release: 1.40<br/>
Date:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2008, July 12
<h3>2.28.2 Defects Fixed</h3>
<ul>
<li>EAX mode ciphers were not resetting correctly after a doFinal/reset. This has been fixed.</li>
<li>The SMIME API was failing to verify doubly nested multipart objects in signatures correctly. This has been fixed.</li>
<li>Some boolean parameters to IssuingDistributionPoint were being reversed. This has been fixed.</li>
<li>A zero length RDN would cause an exception in an X509Name. This has been fixed.</li>
<li>Passing a null to ExtendedPKIXParameters.setTrustedACIssuers() would cause a NullPointerException. This has been fixed.</li>
<li>CertTemplate was incorrectly encoding issuer and subject fields when set.</li>
<li>hashCode() for X509CertificateObject was very poor. This has been fixed.<li>
<li>Specifying a greater than 32bit length for a stream and relying on the default BCPGOutputStream resulted in corrupted data. This has been fixed.</li>
<li>PKCS7Padding validation would not fail if pad length was 0. This has been fixed.</li>
<li>javax.crypto classes no longer appear in the JDK 1.3 provider jar.</li>
<li>Signature creation time was not being properly initialised in new V4 PGP signature objects although the encoding was correct. This has been fixed.</li>
<li>The '+' character can now be escaped or quoted in the constructor for X509Name, X509Prinicipal.</li>
<li>Fix to regression from 1.38: PKIXCertPathValidatorResult.getPublicKey was returning the wrong public key when the BC certificate path validator was used.</li>
</ul>
<h3>2.28.3 Additional Features and Functionality</h3>
<ul>
<li>Galois/Counter Mode (GCM) has been added to the lightweight API and the JCE provider.</li>
<li>SignedPublicKeyAndChallenge and PKCS10CertificationRequest can now take null providers if you need to fall back to the default provider mechanism.</li>
<li>The TSP package now supports validation of responses with V2 signing certificate entries.</li>
<li>Unnecessary local ID attributes on certificates in PKCS12 files are now automatically removed.</li>
<li>The PKCS12 store types PKCS12-3DES-3DES and PKCS12-DEF-3DES-3DES have been added to support generation of PKCS12 files with both certificates and keys protected by 3DES.</li>
</ul>
<h3>2.28.4 Additional Notes</h3>
<ul>
<li>Due to problems for some users caused by the presence of the IDEA algorithm, an implementation is no longer included in the default signed jars. Only the providers of the form bcprov-ext-*-*.jar now include IDEA.</li>
</ul>

<h3>2.29.1 Version</h3>
Release: 1.39<br/>
Date:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2008, March 29
<h3>2.29.2 Defects Fixed</h3>
<ul>
<li>A bug causing the odd NullPointerException has been removed from the LocalizedMessage class.</li>
<li>IV handling in CMS for the SEED and Camellia was incorrect. This has been fixed.</li>
<li>ASN.1 stream parser now throws exceptions for unterminated sequences.</li>
<li>EAX mode was not handling non-zero offsetted data correctly and failing. This has been fixed.</li>
<li>The BC X509CertificateFactory now handles multiple certificates and CRLs in streams that don't support marking.</li>
<li>The BC CRL implementation could lead to a NullPointer exception being thrown if critical extensions were missing. This has been fixed.</li>
<li>Some ASN.1 structures would cause a class cast exception in AuthorityKeyIdentifier. This has been fixed.</li>
<li>The CertID class used by the TSP library was incomplete. This has been fixed.</li>
<li>A system property check in PKCS1Encoding to cause a AccessControlException under some circumstances. This has been fixed.</li>
<li>A decoding issue with a mis-identified tagged object in CertRepMessage has been fixed.</li>
<li>\# is now properly recognised in the X509Name class.</li>
</ul>
<h3>2.29.3 Additional Features and Functionality</h3>
<ul>
<li>Certifications associated with user attributes can now be created, verified and removed in OpenPGP.</li>
<li>API support now exists for CMS countersignature reading and production.</li>
<li>The TSP package now supports parsing of responses with V2 signing certificate entries.</li>
<li>Lazy evaluation of DER sequences has been introduced to ASN1InputStream to allow support for larger sequences.</li>
<li>KeyPurposeId class has been updated for RFC 4945.</li>
<li>CertPath processing has been further extended to encompass the NIST CertPath evaluation suite.</li>
<li>Initial support has been added for HP_CERTIFICATE_REQUEST in the TLS API.</li>
<li>Providers for JDK 1.4 and up now use SignatureSpi directly rather than extending Signature. This is more in track with the way dynamic provider selection now works.</li>
<li>PGP example programs now handle blank names in literal data objects.</li>
<li>The ProofOfPossession class now better supports the underlying ASN.1 structure.</li>
<li>Support has been added to the provider for the VMPC MAC.</li>
</ul>
<h3>2.30.1 Version</h3>
Release: 1.38<br/>
Date:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2007, November 7
<h3>2.30.2 Defects Fixed</h3>
<ul>
<li>SMIME signatures containing non-standard quote-printable data could be altered by SMIME encryption. This has been fixed.</li>
<li>CMS signatures that do not use signed attributes were vulnerable to one of Bleichenbacher's RSA signature forgery attacks. This has been fixed.</li>
<li>The SMIMESignedParser(Part) constructor was not producing a content body part that cleared itself after writeTo() as indicated in the JavaDoc. This has been fixed.</li>
<li>BCPGInputStream now handles data blocks in the 2**31->2**32-1 range.</li>
<li>A bug causing second and later encrypted objects to be ignored in KeyBasedFileProcessor example has been fixed.</li>
<li>Value of the TstInfo.Tsa field is now directly accessible from TimeStampTokenInfo.</li>
<li>Generating an ECGOST-3410 key using an ECGenParameterSpec could cause a ClassCastException in the key generator. This has been fixed.</li>
<li>Use of the parameters J and L in connection with Diffie-Hellman parameters in the light weight API was ambiguous and confusing. This has been dealt with.</li>
<li>Some entities were not fully removed from a PKCS#12 file when deleted due to case issues. This has been fixed.</li>
<li>Overwriting entities in a PKCS#12 file was not fully compliant with the JavaDoc for KeyStore. This has been fixed.</li>
<li>TlsInputStream.read() could appear to return end of file when end of file had not been reached. This has been fixed.</li>
</ul>
<h3>2.30.3 Additional Features and Functionality</h3>
<ul>
<li>Buffering in the streaming CMS has been reworked. Throughput is now usually higher and the behaviour is more predictable.</li>
<li>It's now possible to pass a table of hashes to a CMS detached signature rather than having to always pass the data.</li>
<li>Classes supporting signature policy and signer attributes have been added to the ASN.1 ESS/ESF packages.</li>
<li>Further work has been done on optimising memory usage in ASN1InputStream. In some cases memory usage has been reduced to 25% of previous.</li>
<li>Pre-existing signers can now be added to the SMIMESignedGenerator.</li>
<li>Support has been added to the provider for the VMPC stream cipher.</li>
<li>CertPathReviewer has better handling for problem trust anchors.</li>
<li>Base64 encoder now does initial size calculations to try to improve resource usage.</li>
</ul>
<h3>2.32.1 Version</h3>
Release: 1.37<br/>
Date:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2007, June 15
<h3>2.32.2 Defects Fixed</h3>
<ul>
<li>The ClearSignedFileProcessor example for OpenPGP did not take into account trailing white space in
the file to be signed. This has been fixed.</li>
<li>A possible infinite loop in the CertPathBuilder and SignedMailValidator have been removed.</li>
<li>Requesting DES, DESede, or Blowfish keys using regular Diffie-Hellman now returns the same length keys as the regular JCE provider.</li>
<li>Some uncompressed EC certificates were being interpreted as compressed and causing an exception. This has been fixed.</li>
<li>Adding a CRL with no revocations on it to the CRL generator could cause an exception to be thrown. This has been fixed.</li>
<li>Using the default JDK provider with the CMS library would cause exceptions in some circumstances. This has been fixed.</li>
<li>BC provider DSAKeys are now serializable.</li>
<li>Using only a non-sha digest in S/MIME signed data would produce a corrupt MIME header. This has been fixed.</li>
<li>The default private key length in the lightweght API for generated DiffieHellman parameters was absurdly small, this has been fixed.</li>
<li>Cipher.getParameters() for PBEwithSHAAndTwofish-CBC was returning null after intialisation. This has been fixed.</li>
</ul>
<h3>2.32.3 Additional Features and Functionality</h3>
<ul>
<li>The block cipher mode CCM has been added to the provider and light weight API.</li>
<li>The block cipher mode EAX has been added to the provider and light weight API.</li>
<li>The stream cipher HC-128 and HC-256 has been added to the provider and lightwieght API.</li>
<li>The stream cipher ISAAC has been added to the lightweight API.</li>
<li>Support for producing and parsing notation data signature subpackets has been added to OpenPGP.</li>
<li>Support for implicit tagging has been added to DERApplicationSpecific.</li>
<li>CMS better supports basic Sun provider.</li>
<li>A full set of SEC-2 EC curves is now provided in the SEC lookup table.</li>
<li>Specifying a null provider in CMS now always uses the default provider, rather than causing an exception.</li>
<li>Support has been added to the OpenPGP API for parsing experimental signatures</li>
<li>CertPath validator now handles inherited DSA parameters and a wider range of name constraints.</li>
<li>Further work has been done on improving the performance of ECDSA - it is now about two to six times faster depending on the curve.</li>
<li>The Noekeon block cipher has been added to the provider and the lightweight API.</li>
<li>Certificate generation now supports generation of certificates with an empty Subject if the subjectAlternativeName extension is present.</li>
<li>The JCE provider now supports RIPEMD160withECDSA.</li>
</ul>

<h3>2.33.1 Version</h3>
Release: 1.36<br/>
Date:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2007, March 16
<h3>2.33.2 Defects Fixed</h3>
<ul>
<li>DSA key generator now checks range and keysize.</li>
<li>Class loader issues with i18n classes should now be fixed.</li>
<li>X.500 name serial number value now output as unambiguous long form SERIALNUMBER</li>
<li>The fix for multipart messages with mixed content-transfer-encoding in 1.35 caused a
regression for processing some messages with embedded multiparts that contained blank lines of preamble text - this should now be fixed.</li>
<li>Another regression which sometimes affected the SMIMESignedParser has also been fixed.</li>
<li>SharedFileInputStream compatibility issues with JavaMail 1.4 have been addressed.</li>
<li>JDK 1.5 and later KeyFactory now accepts ECPublicKey/ECPrivateKey to translateKey.</li>
<li>JDK 1.5 and later KeyFactory now produces ECPublicKeySpec/ECPrivateKeySpec on getKeySpec.</li>
<li>Some surrogate pairs were not assembled correctly by the UTF8 decoder. This has been fixed.</li>
<li>Alias resolution in PKCS#12 is now case insensitive.</li>
</ul>
<h3>2.33.3 Additional Features and Functionality</h3>
<ul>
<li>CMS/SMIME now supports basic EC KeyAgreement with X9.63.</li>
<li>CMS/SMIME now supports RFC 3211 password based encryption.</li>
<li>Support has been added for certificate, CRL, and certification request generation for the regular SHA algorithms with RSA-PSS.</li>
<li>Further work has been done in speeding up prime number generation in the lightweight BigInteger class.</li>
<li>Support for the SEED algorithm has been added to the provider and the lightweight API.</li>
<li>Support for the Salsa20 algorithm has been added to the provider and the lightweight API.</li>
<li>CMS/SMIME now support SEED and Camellia</li>
<li>A table of TeleTrusT curves has been added.</li>
<li>CMSSignedData creation and Collection CertStore now preserves the order of certificates/CRls if the backing collection is ordered.</li>
<li>CMS Signed objects now use BER encoding for sets containing certificates and CRLs, allowing specific ordering to be specified for the objects contained.</li>
<li>CMS enveloped now works around providers which throw UnsupportedOperationException if key wrap is attempted.</li>
<li>DSASigner now handles long messages. SHA2 family digest support for DSA has been added to the provider.</li>
</ul>

<h3>2.34.1 Version</h3>
Release: 1.35<br/>
Date:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2006, December 16
<h3>2.34.2 Defects Fixed</h3>
<ul>
<li>Test data files are no longer in the provider jars.</li>
<li>SMIMESignedParser now handles indefinite length data in SignerInfos.</li>
<li>Under some circumstances the SMIME library was failing to canonicalize mixed-multipart data correctly. This has been fixed.</li>
<li>The l parameter was being ignored for the DH and ElGamal key generation. This has been fixed.</li>
<li>The ASN1Sequence constructor for OtherRecipientInfo was broken. It has been fixed</li>
<li>Regression - DN fields SerialNumber and Country were changed to encode as UTF8String in 1.34 in the X509DefaultEntryConverter, these now encode as PrintableString.</li>
<li>CMSSignedData.replaceSigners() was not replacing the digest set as well as the signers. This has been fixed.</li>
<li>DERGeneralizedTime produced a time string without a GMT offset if they represented local time. This has been fixed.</li>
<li>Some temp files were still being left on Windows by the SMIME library. All of the known problems have been fixed.</li>
<li>Comparing ASN.1 object for equality would fail in some circumstances. This has been fixed.
<li>The IESEngine could incorrectly encrypt data when used in block cipher mode. This has been fixed.
<li>An error in the encoding of the KEKRecipientInfo has been fixed. Compatability warning: this may mean that versions of BC mail prior to 1.35 will have trouble processing KEK messages produced by 1.35 or later.
</ul>
<h3>2.34.3 Additional Features and Functionality</h3>
<ul>
<li>Further optimisations to elliptic curve math libraries.</li>
<li>API now incorporates a CertStore which should be suitable for use with LDAP.</li>
<li>The streaming ASN.1 API is now integrated into the base one, the sasn1 package has been deprecated.</li>
<li>The OpenPGP implementation now supports SHA-224 and BZIP2.</li>
<li>The OpenPGP implementation now supports SHA-1 checksumming on secret keys.</li>
<li>The JCE provider now does RSA blinding by default.</li>
<li>CMSSignedDataParser now provides methods for replacing signers and replacing certificates and CRLs.</li>
<li>A generic store API has been added to support CRLs, Certificates and Attribute certificates.</li>
<li>The CMS/SMIME API now supports inclusion and retrieval of version 2 attribute certificates.</li>
<li>Support for generating CertificationRequests and Certificates has been added for GOST-3410-2001 (ECGOST)</li>
<li>CMS/SMIME now support ECGOST</li>
<li>Basic BER Octet Strings now encode in a canonical fashion by default.</li>
<li>DERUTCTime can now return Date objects</li>
<li>Validating constructors have been added to DERPrintableString, DERIA5String, and DERNumericString.</li>
<li>A lightweight API for supporting TLS has been added.</li>
<li>Implementations of the TEA and XTEA ciphers have been added to the light weight API and the provider.</li>
<li>PEMReader now supports OpenSSL ECDSA key pairs.</li>
<li>PGP packet streams can now be closed off using close() on the returned stream as well as closing the generator.</li>
</ul>
<h3>2.35.1 Version</h3>
Release: 1.34<br/>
Date:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2006, October 2
<h3>2.35.2 Defects Fixed</h3>
<ul>
<li>Endianess of integer conversion in KDF2BytesGenerator was incorrect. This has been fixed.
<li>Generating critical signature subpackets in OpenPGP would result in a zero packet tag. This has been fixed.
<li>Some flags in PKIFailure info were incorrect, and the range of values was incomplete. The range of values has been increased and the flags corrected.
<li>The helper class for AuthorityKeyExtension generation was including the subject rather than the issuer DN of the CA certificate. This has been fixed.
<li>SMIMESignedParser now avoids JavaMail quoted-printable recoding issue.
<li>Verification of RSA signatures done with keys with public exponents of 3 was vunerable to
Bleichenbacher's RSA signature forgery attack. This has been fixed.
<li>PGP Identity strings were only being interpreted as ASCII rather than UTF8. This has been fixed.
<li>CertificateFactory.generateCRLs now returns a Collection rather than null.
</ul>
<h3>2.35.3 Additional Features and Functionality</h3>
<ul>
<li>An ISO18033KDFParameters class had been added to support ISO18033 KDF generators.
<li>An implemention of the KDF1 bytes generator algorithm has been added.
<li>An implementation of NaccacheStern encryption has been added to the lightweight API.
<li>X509V2CRLGenerator can now be loaded from an existing CRL.
<li>The CMS enveloped data generators will now attempt to use the default provider for encryption if the passed in provider can only handle key exchange.
<li>OpenPGP file processing has been substantially speeded up.
<li>The PKCS1Encoder would accept PKCS1 packets which were one byte oversize. By default this will now cause an error. However, as there are still implementations which still produce such packets the older behaviour can be turned on by setting the VM system property org.bouncycastle.pkcs1.strict to false before creating an RSA cipher using PKCS1 encoding.
<li>A target has been added to the bc-build.xml to zip up the source code rather than leaving it in a directory tree.
The build scripts now run this target by default.
<li>Use of toUpperCase and toLowerCase has been replaced with a locale independent converter where appropriate.
<li>Support for retrieving the issuers of indirect CRLs has been added.
<li>Classes for doing incremental path validation of PKIX cert paths have been added to the X.509 package and S/MIME.
<li>Locale issues with String.toUpperCase() have now been worked around.
<li>Optional limiting has been added to ASN1InputStream to avoid possible OutOfMemoryErrors on corrupted streams.
<li>Support has been added for SHA224withECDSA, SHA256withECDSA, SHA384withECDSA, and SHA512withECDSA for the generation of signatures, certificates, CRLs, and certification requests.
<li>Performance of the prime number generation in the BigInteger library has been further improved.
<li>In line with RFC 3280 section 4.1.2.4 DN's are now encoded using UTF8String by default rather than PrintableString.
</ul>
<h3>2.35.4 Security Advisory</h3>
<ul>
<li>If you are using public exponents with the value three you *must* upgrade to this release, otherwise it
will be possible for attackers to exploit some of Bleichenbacher's RSA signature forgery attacks on your applications.</li>
</ul>
<h3>2.36.1 Version</h3>
Release: 1.33<br/>
Date:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2006, May 3
<h3>2.36.2 Defects Fixed</h3>
<ul>
<li>OCSPResponseData was including the default version in its encoding. This has been fixed.
<li>BasicOCSPResp.getVersion() would throw a NullPointer exception if called on a default version response. This has been fixed.
<li>Addition of an EC point under Fp could result in an ArithmeticException. This has been fixed.
<li>The n value for prime192v2 was incorrect. This has been fixed.
<li>ArmoredInputStream was not closing the underlying stream on close. This has been fixed.
<li>Small base64 encoded strings with embedded white space could decode incorrectly using the Base64 class. This has been fixed.
</ul>
<h3>2.36.3 Additional Features and Functionality</h3>
<ul>
<li>The X509V2CRLGenerator now supports adding general extensions to CRL entries.
<li>A RoleSyntax implementation has been added to the x509 ASN.1 package, and the AttributeCertificateHolder class now support the IssuerSerial option.
<li>The CMS API now correctly recognises the OIW OID for DSA with SHA-1.
<li>DERUTF8String now supports surrogate pairs.
</ul>

<h3>2.37.1 Version</h3>
Release: 1.32<br/>
Date:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2006, March 27
<h3>2.37.2 Defects Fixed</h3>
<ul>
<li>Further work has been done on RFC 3280 compliance.
<li>The ASN1Sequence constructor for SemanticsInformation would sometimes throw a ClassCastException on reconstruction an object from a byte stream. This has been fixed.
<li>The SharedInputStream.read(buf, 0, len) method would return 0 at EOF, rather than -1. This has been fixed.
<li>X9FieldElement could fail to encode a Fp field element correctly. This has been fixed.
<li>The streaming S/MIME API was occasionally leaving temporary files around. The SIMEUtil class responsible for creating the files now returns a FileBackedMimeBodyPart object
which has a dispose method on it which should allow removal of the file backing the body part.
<li>An encoding defect in EnvelopedData generation in the CMS streaming, S/MIME API has been fixed.
<li>DER constructed octet strings could cause exceptions in the streaming ASN.1 library. This has been fixed.
<li>Several compatibility issues connected with EnvelopedData decoding between the streaming CMS library and other libraries have been fixed.
<li>JDK 1.4 and earlier would sometimes encode named curve parameters explicitly. This has been fixed.
<li>An incorrect header for SHA-256 OpenPGP clear text signatures has been fixed.
<li>An occasional bug that could result in invalid clear text signatures has been fixed.
<li>OpenPGP clear text signatures containing '\r' as line separators were not being correctly canonicalized. This has been fixed.
</ul>

<h3>2.37.3 Additional Features and Functionality</h3>
<ul>
<li>The ASN.1 library now includes classes for the ICAO Electronic Passport.
<li>Support has been added to CMS and S/MIME for ECDSA.
<li>Support has been added for the SEC/NIST elliptic curves.
<li>Support has been added for elliptic curves over F2m.
<li>Support has been added for repeated attributes in CMS and S/MIME messages.
<li>A wider range of RSA-PSS signature types is now supported for CRL and Certificate verification.
</ul>
<h3>2.37.4 Possible compatibility issue</h3>
<ul>
<li>Previously elliptic curve keys and points were generated with point compression enabled by default.
Owing to patent issues in some jurisdictions, they are now generated with point compression disabled by default.
</ul>

<h3>2.38.1 Version</h3>
Release: 1.31<br/>
Date:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2005, December 29
<h3>2.38.2 Defects Fixed</h3>
<ul>
<li>getCriticalExtensionOIDs on an X.509 attribute certificate was returning the non-critical set. This has been fixed.
<li>Encoding uncompressed ECDSA keys could occasionally introduce an extra leading zero byte. This has been fixed.
<li>Expiry times for OpenPGP master keys are now recognised across the range of possible certifications.
<li>PGP 2 keys can now be decrypted by the the OpenPGP library.
<li>PGP 2 signature packets threw an exception on trailer processing. This has been been fixed.
<li>Attempting to retrieve signature subpackets from an OpenPGP version 3 signature would throw a null pointer exception. This has been fixed.
<li>Another occasional defect in EC point encoding has been fixed.
<li>In some cases AttributeCertificateHolder.getIssuer() would return an empty array for attribute certificates using the BaseCertificateID.
This has been fixed.
<li>OIDs with extremely large components would sometimes reencode with unnecessary bytes in their encoding. The optimal DER encoding will now be produced instead.
</ul>
<h3>2.38.3 Additional Features and Functionality</h3>
<ul>
<li>The SMIME package now supports the large file streaming model as well.
<li>Additional ASN.1 message support has been added for RFC 3739 in the org.bouncycastle.x509.qualified package.
<li>Support has been added for Mac algorithm 3 from ISO 9797 to both the lightweight APIs and the provider.
<li>The provider now supports the DESEDE64 MAC algorithm.
<li>CertPathValidator has been updated to better support path validation as defined in RFC 3280.
</ul>

<h3>2.39.1 Version</h3>
Release: 1.30<br/>
Date:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2005, September 18
<h3>2.39.2 Defects Fixed</h3>
<ul>
<li>Whirlpool was calculating the wrong digest for 31 byte data and could throw an exception for some other data lengths. This has been fixed.
<li>AlgorithmParameters for IVs were returning a default of RAW encoding of the parameters when they should have been returning an
ASN.1 encoding. This has been fixed.
<li>Base64 encoded streams without armoring could cause an exception in PGPUtil.getDecoderStream(). This has been fixed.
<li>PGPSecretKey.copyWithNewPassword() would incorrectly tag sub keys. This has been fixed.
<li>PGPSecretKey.copyWithNewPassword() would not handle the NULL algorithm. This has been fixed.
<li>Directly accessing the dates on an X.509 Attribute Certificate constructed from an InputStream would return null, not the date objects. This has been fixed.
<li>KEKIdentifier would not handle OtherKeyAttribute objects correctly. This has been fixed.
<li>GetCertificateChain on a PKCS12 keystore would return a single certificate chain rather than null if the alias passed in represented a certificate not a key. This has been fixed.
</ul>
<h3>2.39.3 Additional Features and Functionality</h3>
<ul>
<li>RSAEngine no longer assumes keys are byte aligned when checking for out of range input.
<li>PGPSecretKeyRing.removeSecretKey and PGPSecretKeyRing.insertSecretKey have been added.
<li>There is now a getter for the serial number on TimeStampTokenInfo.
<li>Classes for dealing with CMS objects in a streaming fashion have been added to the CMS package.
<li>PGPCompressedDataGenerator now supports partial packets on output.
<li>OpenPGP Signature generation and verification now supports SHA-256, SHA-384, and SHA-512.
<li>Both the lightweight API and the provider now support the Camellia encryption algorithm.
</ul>

<h3>2.40.1 Version</h3>
Release: 1.29<br/>
Date:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2005, June 27
<h3>2.40.2 Defects Fixed</h3>
<ul>
<li>HMac-SHA384 and HMac-SHA512 were not IETF compliant. This has been fixed.
<li>The equals() method on ElGamalKeyParameters and DHKeyParameters in the lightweight API would sometimes
return false when it should return true. This has been fixed.
<li>Parse error for OpenSSL style PEM encoded certificate requests in the PEMReader has been fixed.
<li>PGPPublicKey.getValidDays() now checks for the relevant signature for version 4 and later keys as well as using the
version 3 key valid days field.
<li>ISO9796 signatures for full recovered messsages could incorrectly verify for similar messages in some circumstances. This has been fixed.
<li>The occasional problem with decrypting PGP messages containing compressed streams now appears to be fixed.
</ul>
<h3>2.40.3 Additional Features and Functionality</h3>
<ul>
<li>Support has been added for the OIDs and key generation required for HMac-SHA224, HMac-SHA256, HMac-SHA384, and 
HMac-SHA512.
<li>SignerInformation will used default implementation of message digest if signature provider doesn't support it.
<li>The provider and the lightweight API now support the GOST-28147-94 MAC algorithm.
<li>Headers are now settable for PGP armored output streams.
</ul>
<h3>2.40.4 Notes</h3>
<ul>
<li>The old versions of HMac-SHA384 and HMac-SHA512 can be invoked as OldHMacSHA384 and OldHMacSHA512, or by using the OldHMac class in the
lightweight API.
</ul> 
<h3>2.41.1 Version</h3>
Release: 1.28<br/>
Date:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2005, April 20
<h3>2.41.2 Defects Fixed</h3>
<ul>
<li>Signatures on binary encoded S/MIME messages could fail to validate when correct. This has been fixed.
<li>getExtensionValue() on CRL Entries were returning the encoding of the inner object, rather than the octet string. This has been fixed.
<li>CertPath implementation now returns an immutable list for a certificate path.
<li>Generic sorting now takes place in the CertificateFactory.generateCertPath() rather than CertPathValidator.
<li>DERGeneralizedTime can now handle time strings with milli-seconds.
<li>Stateful CertPathCheckers were not being initialised in all cases, by the CertPathValidator. This has been fixed.
<li>PGPUtil file processing methods were failing to close files after processing. This has been fixed.
<li>A disordered set in a CMS signature could cause a CMS signature to fail to validate when it should. This has been fixed.
<li>PKCS12 files where both the local key id and friendly name were set on a certificate would not parse correctly. This has been fixed.
<li>Filetype for S/MIME compressed messages was incorrect. This has been fixed.
<li>BigInteger class can now create negative numbers from byte arrays.
</ul>
<h3>2.41.3 Additional Features and Functionality</h3>
<ul>
<li>S/MIME now does canonicalization on non-binary input for signatures.
<li>Micalgs for the new SHA schemes are now supported.
<li>Provided and lightweight API now support ISO 7816-4 padding.
<li>The S/MIME API now directly supports the creation of certificate management messages.
<li>The provider and the light weight API now support the cipher GOST-28147, the signature algorithms GOST-3410 (GOST-3410 94) and EC GOST-3410 (GOST-3410 2001), the message digest GOST-3411 and the GOST OFB mode (use GOFB).
<li>CMSSignedDataGenerator will used default implementation of message digest if signature provider doesn't support it.
<li>Support has been added for the creation of ECDSA certificate requests.
<li>The provider and the light weight API now support the WHIRLPOOL message digest.
</ul>
<h3>2.41.4 Notes</h3>
<ul>
<li>Patches for S/MIME binary signatures and canonicalization were actually applied in 1.27, but a couple of days after the release - if the class 
CMSProcessableBodyPartOutbound is present in the package org.bouncycastle.mail.smime you have the patched 1.27. We would recommend upgrading to 1.28 in any case
as some S/MIME 3.1 recommendations have also been introduced for header creation.
<li>GOST private keys are probably not encoding correctly and can be expected to change.
</ul>
<h3>2.42.1 Version</h3>
Release: 1.27<br/>
Date:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2005, February 20
<h3>2.42.2 Defects Fixed</h3>
<ul>
<li>Typos in the provider which pointed Signature algorithms SHA256WithRSA, SHA256WithRSAEncryption, SHA384WithRSA, SHA384WithRSAEncryption, SHA512WithRSA, and SHA512WithRSAEncryption at the PSS versions of the algorithms have been fixed. The correct names for the PSS algorithms are SHA256withRSAandMGF1, SHA384withRSAandMGF1, and SHA512withRSAandMGF1.
<li>X509CertificateFactory failed under some circumstances to reset properly if the input stream being passed
to generateCertificate(s)() changed, This has been fixed.
<li>OpenPGP BitStrength for DSA keys was being calculated from the key's generator rather than prime. This has been fixed.
<li>Possible infinite loop in ASN.1 SET sorting has been removed.
<li>SHA512withRSAandMGF1 with a zero length salt would cause an exception if used with a 1024 bit RSA key. This has been fixed.
<li>Adding an Exporter to a PGPSubpacketVector added a Revocable instead. This has been fixed.
<li>AttributeCertificateIssuer.getPrincipal() could throw an ArrayStoreException. This has been fixed.
<li>CertPathValidator now guarantees to call any CertPathCheckers passed in for each certificate.
<li>TSP TimeStampToken was failing to validate time stamp tokens with the issuerSerial field set in the ESSCertID structure. This has been fixed.
<li>Path validation in environments with frequently updated CRLs could occasionally reject a valid path. This has been fixed.
</ul>
<h3>2.42.3 Additional Features and Functionality</h3>
<ul>
<li>Full support has been added for the OAEPParameterSpec class to the JDK 1.5 povider.
<li>Full support has been added for the PSSParameterSpec class to the JDK 1.4 and JDK 1.5 providers.
<li>Support for PKCS1 signatures for SHA-256, SHA-384, and SHA-512 has been added to CMS.
<li>PGPKeyRingCollection classes now support partial matching of user ID strings.
<li>This release disables the quick check on the IV for a PGP public key encrypted message in order to help
prevent applications being vunerable to oracle attacks.
<li>The CertPath support classes now support PKCS #7 encoding.
<li>Point compression can now be turned off when encoding elliptic curve keys.
</ul>
<h3>2.42.4 Changes that may affect compatibility</h3>
<ul>
<li>org.bouncycastle.jce.interfaces.ElGamalKey.getParams() has been changed to getParameters() to avoid clashes with
a JCE interface with the same method signature.
<li>org.bouncycastle.jce.interfaces.ECKey.getParams() has been changed in JDK 1.5 to getParameters() to avoid clashes
with a JCE interface with the same method signature. The getParams() method in pre-1.5 has been deprecated.
<li>SHA256WithRSAEncryption, SHA384WithRSAEncryption, SHA512WithRSAEncryption now refer to their PKCS #1 V1.5 implementations. If you
were using these previously you should use SHA256WithRSAAndMGF1, SHA384WithRSAAndMGF1, or SHA512WithRSAAndMGF1.
</ul>
<h3>2.43.1 Version</h3>
Release: 1.26<br/>
Date:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2005, January 15
<h3>2.43.2 Defects Fixed</h3>
<ul>
<li>The X.509 class UserNotice assumed some of the optional fields were not optional. This has been fixed.
<li>BCPGInputStream would break on input packets of 8274 bytes in length. This has been fixed.
<li>Public key fingerprints for PGP version 3 keys are now correctly calculated.
<li>ISO9796-2 PSS would sometimes throw an exception on a correct signature. This has been fixed.
<li>ASN1Sets now properly sort their contents when created from scratch.
<li>A bug introduced in the CertPath validation in the last release which meant some certificate paths would validate if they were invalid has been fixed.
</ul>
<h3>2.43.3 Additional Features and Functionality</h3>
<ul>
<li>Support for JDK 1.5 naming conventions for OAEP encryption and PSS signing has been added.
<li>Support for Time Stamp Protocol (RFC 3161) has been added.
<li>Support for Mozilla's PublicKeyAndChallenge key certification message has been added.
<li>OpenPGP now supports key rings containing GNU_DUMMY_S2K.
<li>Support for the new versions (JDK 1.4 and later) of PBEKeySpec has been added to the providers.
<li>PBEWithMD5AndRC2, PBEWithSHA1AndRC2 now generate keys rather than exceptions.
<li>The BigInteger implementation has been further optimised to take more advantage of the Montgomery number capabilities.
</ul>
<h3>2.43.4 JDK 1.5 Changes</h3>
<ul>
<li>The JDK 1.5 version of the provider now supports the new Elliptic Curve classes found in the java.security packages. Note: while we have tried to preserve some backwards compatibility people using Elliptic curve are likely to find some minor code changes are required when moving code from JDK 1.4 to JDK 1.5 as the java.security APIs have changed.
</ul>

<h3>2.44.1 Version</h3>
Release: 1.25<br/>
Date:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2004, October 1
<h3>2.44.2 Defects Fixed</h3>
<ul>
<li>In some situations OpenPGP would overread when a stream had been
broken up into partial blocks. This has been fixed.
<li>Explicitly setting a key size for RC4 in the CMS library would cause
an exception. This has been fixed.
<li>getSignatures() on PGPPublicKey would throw a ClassCastException in some cases. This has been fixed.
<li>Encapsulated signed data was been generated with the wrong mime headers, this has been fixed.
<li>The isSignature method on PGPSecretKey now correctly identifies signing keys.
<li>An interoperability issue with DH key exchange between the Sun JCE provider and the BC provider, concerning sign bit expansion, has been fixed. 
<li>The X509CertificateFactory would fail to reset correctly after reading an ASN.1 certificate chain. This has been fixed.
<li>CertPathValidator now handles unsorted lists of certs.
<li>The PGPSignatureGenerator would sometimes throw an exception when adding hashed subpackets. This has been fixed.
<li>Ordered equality in X509Name was not terminating as early as possible. This has been fixed.
<li>getBitStrength for PGPPublicKeys was returning the wrong value for ElGamal keys. This has been fixed.
<li>getKeyExpirationTime/getSignatureExpirationTime was returning a Date rather than a delta. This isn't meaningful as a Date and has been changed to a long.
<li>the crlIssuer field in DistributionPoint name was encoding/decoding incorrectly. This has been fixed.
<li>X509Name now recognises international characters in the input string and
stores them as BMP strings.
<li>Parsing a message with a zero length body with SMIMESigned would cause an exception. This has been fixed.
<li>Some versions of PGP use zeros in the data stream rather than a replication of the last two bytes of the iv as specified in the RFC to determine if the correct decryption key has been found. The decryption classes will now cope with both.
</ul>
<h3>2.44.3 Additional Features and Functionality</h3>
<ul>
<li>Support for extracting signatures based on PGP user attributes has been
added to PGPPublicKey.
<li>BCPGArmoredInputStream should cope with plain text files better.
<li>The OpenPGP library can now create indefinite length streams and handle packets greater than (2^32 - 1) in length.
<li>Direct support for adding SignerUserID and PrimaryUserID has been added to the PGPSignatureSubpacketGenerator.
<li>Support for ISO-9796-2/PSS has been added to the lightweight API.
<li>API support for extracting recovered messages from signatures that support
message recovery has been added to the lightweight API.
<li>String value conversion in a DN being processed by X509Name is now fully
configurable.
<li>It is now possible to create new versions of CMSSignedData objects without
having to convert the original object down to its base ASN.1 equivalents.
<li>Support for adding PGP revocations and other key signatures has been added.
<li>Support for SHA-224 and SHA224withRSA has been added.
<li>Trailing bit complement (TBC) padding has been added.
<li>OID components of up to 2^63 bits are now supported.
</ul>
<h3>2.45.1 Version</h3>
Release: 1.24<br/>
Date:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2004, June 12
<h3>2.45.2 Defects Fixed</h3>
<ul>
<li>OpenPGP Secret key rings now parse key rings with user attribute packets in them correctly.
<li>OpenPGP Secret key rings now parse key rings with GPG comment packets in them.
<li>X509Name and X509Principal now correctly handle BitStrings.
<li>OpenPGP now correctly recognises RSA signature only keys.
<li>When re-encoding PGP public keys taken off secret keys getEncoded would
sometimes throw a NullPointerException. This has been fixed.
<li>A basic PKCS12 file with a single key and certificate, but no attributes, would cause a null pointer exception. This has been fixed.
<li>Signature verification now handles signatures where the parameters block is missing rather than NULL.
<li>Lightweight CBCBlockCipherMac was failing to add padding if padding was
being explicitly provided and data length was a multiple of the block size. This has been fixed.
<li>ZIP compression in PGP was failing to compress data in many cases. This has been fixed.
<li>Signatures were occasionally produced with incorrect padding in their associated bit strings, this has been fixed.
<li>An encoding error introduced in 1.23 which affected generation of the
KeyUsage extension has been fixed.
</ul>
<h3>2.45.3 Additional Features and Functionality</h3>
<ul>
<li>PKCS12 keystore now handles single key/certificate files without any attributes present.
<li>Support for creation of PGPKeyRings incorporating sub keys has been added.
<li>ZeroPadding for encrypting ASCII data has been added.
</ul>
<h3>2.46.1 Version</h3>
Release: 1.23<br/>
Date:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2004, April 10
<h3>2.46.2 Defects Fixed</h3>
<ul>
<li>Reading a PGP Secret key file would sometimes cause a class cast exception. This has been fixed.
<li>PGP will now read SecretKeys which are encrypted with the null algorithm.
<li>PGP ObjectFactory will recognise Marker packets.
<li>BasicConstraints class now handles default empty sequences correctly.
<li>S2K Secret Key generation now supported in OpenPGP for keys greater than 160 bits, a bug causing
it to occasionally generate the wrong key has been fixed.
<li>OpenPGP implementation can now read PGP 8 keys.
<li>Decoding issues with Secret Sub Keys should now be fixed.
<li>PGP would occasionally unpack ElGamal encrypted data incorrectly, this has been fixed.
<li>OCSP TBSRequest now uses abbreviated encoding if the default version is used.
<li>X509Name class will now print names with nested pairs in component sets correctly.
<li>RC4 now resets correctly on doFinal.
</ul>
<h3>2.46.3 Additional Features and Functionality</h3>
<ul>
<li>PGP V3 keys and V3 signature generation is now supported.
<li>Collection classes have been added for representing files of PGP public and secret keys.
<li>PEMReader now supports "RSA PUBLIC KEY".
<li>RipeMD256 and RipeMD320 have been added.
<li>Heuristic decoder stream has been added to OpenPGP which "guesses" how the input is
constructed.
<li>ArmoredInputStream now recognises clear text signed files.
<li>ArmoredOutputStream now provides support for generating clear text signed files.
<li>Support has been added to CMS for RipeMD128, RipeMD160, and RipeMD256.
<li>Support for generating certification directly and editing PGP public key
certifications has been added.
<li>Support has been added for modification detection codes to the PGP library.
<li>Examples have been rewritten to take advantage of the above.
<li>SMIMESigned can now covert data straight into a mime message.
<li>DERGeneralizedTime getTime() method now handles a broader range of input strings.
</ul>

<h3>2.47.1 Version</h3>
Release: 1.22<br/>
Date:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2004, February 7
<h3>2.47.2 Defects Fixed</h3>
<ul>
<li>Generating DSA signatures with PGP would cause a class cast exception, this has been fixed.
<li>PGP Data in the 192 to 8383 byte length would sometimes be written with the wrong length header. This has been fixed.
<li>The certificate factory would only parse the first certificate in a PKCS7 object. This has been fixed.
<li>getRevocationReason() in RevokedStatus in OCSP would throw an exception for
a non-null reason, rather than a null one. This has been fixed.
<li>PSS signature verification would fail approximately 0.5 % of the time on correct signatures. This has been fixed.
<li>Encoding of CRL Distribution Points now always works.
</ul>
<h3>2.47.3 Additional Features and Functionality</h3>
<ul>
<li>Additional methods for getting public key information have been added to the PGP package.
<li>Some support for user attributes and the image attribute tag has been added.
<li>Support for the AuthorityInformationAccess extension has been added.
<li>Support for ElGamal encryption/decryption has been added to the PGP package.
</ul>

<h3>2.48.1 Version</h3>
Release: 1.21<br/>
Date:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2003, December 6
<h3>2.48.2 Defects Fixed</h3>
<ul>
<li>The CertPath validator would fail for some valid CRLs. This has been  fixed.
<li>AES OIDS for S/MIME were still incorrect, this has been fixed.
<li>The CertPathBuilder would sometimes throw a NullPointerException looking for an issuer. This has been fixed.
<li>The J2ME BigInteger class would sometimes go into an infinite loop generating prime numbers. This has been fixed.
<li>DERBMPString.equals() would throw a class cast exception. This has been fixed.
</ul>
<h3>2.48.3 Additional Features and Functionality</h3>
<ul>
<li>PEMReader now handles public keys.
<li>OpenPGP/BCPG should now handle partial input streams. Additional methods for reading subpackets off signatures.
<li>The ASN.1 library now supports policy qualifiers and policy info objects.
</ul>

<h3>2.49.1 Version</h3>
Release: 1.20<br/>
Date:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2003, October 8
<h3>2.49.2 Defects Fixed</h3>
<ul>
<li>BigInteger toString() in J2ME/JDK1.0 now produces same output as the Sun one.
<li>RSA would throw a NullPointer exception with doFinal without arguments. This has been fixed.
<li>OCSP CertificateID would calculate wrong issuer hash if issuer cert was not self signed. This has been fixed.
<li>Most of response generation in OCSP was broken. This has been fixed.
<li>The CertPath builder would sometimes go into an infinite loop on some chains if the trust anchor was missing. This has been fixed.
<li>AES OIDS were incorrect, this has been fixed.
<li>In some cases BC generated private keys would not work with the JSSE. This has been fixed.
</ul>
<h3>2.49.3 Additional Features and Functionality</h3>
<ul>
<li>Support for reading/writing OpenPGP public/private keys and OpenPGP signatures has been added.
<li>Support for generating OpenPGP PBE messages and public key encrypted messages has been added.
<li>Support for decrypting OpenPGP messages has been added.
<li>Addition of a Null block cipher to the light weight API.
</ul>

<h3>2.50.1 Version</h3>
Release: 1.19<br/>
Date:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2003, June 7
<h3>2.50.2 Defects Fixed</h3>
<ul>
<li>The PKCS12 store would throw an exception reading PFX files that had attributes with no values. This has been fixed.
<li>RSA Private Keys would not serialise if they had PKCS12 bag attributes attached to them, this has been fixed.
<li>GeneralName was encoding OtherName as explicitly tagged, rather than implicitly tagged. This has been fixed.
<li>ASN1 parser would sometimes mistake an implicit null for an implicit empty
sequence. This has been fixed.
</ul>
<h3>2.50.3 Additional Features and Functionality</h3>
<ul>
<li>S/MIME and CMS now support the draft standard for AES encryption.
<li>S/MIME and CMS now support setable key sizes for the standard algorithms.
<li>S/MIME and CMS now handle ARC4/RC4 encrypted messages.
<li>The CertPath validator now passes the NIST test suite.
<li>A basic OCSP implementation has been added which includes request generation
and the processing of responses. Response generation is also provided, but should be treated as alpha quality code.
<li>CMS now attempts to use JCA naming conventions in addition to the OID name
in order to find algorithms.
</ul>

<h3>2.51.1 Version</h3>
Release: 1.18<br/>
Date:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2003, February 8
<h3>2.51.2 Defects Fixed</h3>
<ul>
<li>DESKeySpec.isParityAdjusted in the clean room JCE could go into an
infinite loop. This has been fixed.
<li>The SMIME API would end up throwing a class cast exception if a
MimeBodyPart was passed in containing a MimeMultipart. This is now fixed.
<li>ASN1InputStream could go into an infinite loop reading a truncated
input stream. This has been fixed.
<li>Seeding with longs in the SecureRandom for the J2ME and JDK 1.0,
only used 4 bytes of the seed value. This has been fixed.
</ul>
<h3>2.51.3 Additional Features and Functionality</h3>
<ul>
<li>The X.509 OID for RSA is now recognised by the provider as is the OID for RSA/OAEP.
<li>Default iv's for DES are now handled correctly in CMS.
<li>The ASN.1 classes have been updated to use the generic ASN1* classes where
possible.
<li>A constructor has been added to SMIMESigned to simplify the processing
of "application/pkcs7-mime; smime-type=signed-data;" signatures.
<li>Diffie-Hellman key generation is now faster in environments using the
Sun BigInteger library.
</ul>
<h3>2.52.1 Version</h3>
Release: 1.17<br/>
Date:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2003, January 8
<h3>2.52.2 Defects Fixed</h3>
<ul>
<li>Reuse of an CMSSignedObject could occasionally result in a class
cast exception. This has been fixed.
<li>The X.509 DistributionPointName occasionally encoded incorrectly. This has
been fixed.
<li>BasicConstraints construction would break if an ASN.1 sequence was used
with only the required parameter. This has been fixed.
<li>The DERObject constructor in OriginatorIdentifierOrKey was leaving 
the id field as null. This has been fixed.
</ul>
<h3>2.52.3 Additional Functionality and Features</h3>
<ul>
<li>RC2 now supports the full range of parameter versions and effective
key sizes.
<li>CompressedData handling has been added to CMS/SMIME.
<li>The 1.4 version now allows X500Principles to be generated directly
from CRLs.
<li>SMIME objects now support binary encoding. The number of signature
types recognised has been increased. 
<li>CMS can create signed objects with encapsulated data. Note: while
this was been done we realised we could simplify things, we did and
for the most part people won't notice, other than the occasional
reference to CMSSignable will need to be replaced with CMSProcessable.
<li>X509Name and X509Principal now support forward and reverse X509Name
to string conversion, with changeable lookup tables for converting OIDs
into strings. Both classes also now allow the direction of encoding to
be set when a string is converted as well as changeable lookup tables for
string to OID conversion.
</ul>

<h3>2.53.1 Version</h3>
Release: 1.16<br/>
Date:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2002, November 30
<h3>2.53.2 Defects Fixed</h3>
<ul>
<li>CRLS were only working for UTC time constructed Time objects, this has
been fixed.
<li>KeyUsage and ReasonFlags sometimes encoded longer than necessary. This
has been fixed.
<li>BER encoded sets are now recognised and dealt with.
<li>Encoding issues in CMS which were causing problems with backwards
compatibility with older CMS/SMIME clients have been fixed.
<li>KeyFactory now allows for creation of RSAKey*Spec classes.
<li>The X509CertSelector in the clean room CertPath API is now less likely
to throw a NullPointerException at the wrong time.
<li>Macs now clone correctly in the clean room JCE.
</ul>
<h3>2.53.3 Additional Functionality and Features</h3>
<ul>
<li>PGPCFB support has been added to the provider and the lightweight API.
<li>There are now three versions of the AESEngine, all faster than before,
with the largest footprint one being the fastest. The JCE AES now refers
to the fastest.
<li>The 1.4 version of the library now allows for X500Principals to be
generated directly from certificates.
<li>X509Name has been extended to parse numeric oids, "oid." oids, and to
recognise the LDAP UID.
<li>Immutable sequences and sets have been introduced to the ASN.1 package.
<li>The SMIME/CMS ASN.1 base classes have been rewritten to reduce the
size of the package for use with the lightweight API.
<li>The SMIME/CMS api's have been rewritten to allow them to take advantage
of the Cert Path API, remove code suited to inclusion in the provider,
and to support multiple recipients/signers.
</ul>
<h3>2.54.1 Version</h3>
Release: 1.15<br/>
Date:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2002, September 6
<h3>2.54.2 Defects Fixed</h3>
<ul>
<li>The base string for the oids in asn1.x509.KeyPurposeId was incorrect. This
has been fixed.
<li>MimeBodyParts in the SMIME Generator did not have their Content-Type
properly set up after decryption. This has been fixed.
<li>If a X.509 certificate did not have all the keyUsage extension bits set,
the provider wasn't padding the return value of the key usage extension to
8 booleans in length. This has been fixed.
<li>In some cases the simple BC keystore allowed overwriting of an alias with
one of the same name. This has been fixed.
<li>The key schedule for RC5-64 was not always being calculated correctly. This
has been fixed.
<li>On reset buffered blockcipher was only partially erasing the previous buffer. This has been fixed.
<li>All lightweight mac classes now do a reset on doFinal.
<li>ASN.1 object identifiers wouldn't encode the first byte correctly if the
OID started with 2 and the second number was greater than 47. This has been
fixed.
<li>If a key had PKCS9 attributes associated with it on storage they took
precedence over the local alias used to add the key to the PKCS12 key store.
The local name now takes precedence.
<li>ReasonFlags now correctly encodes.
</ul>
<h3>2.54.3 Additional Functionality and Features</h3>
<ul>
<li>The PKCS12 key store now handles key bags in encryptedData bags.
<li>The X509NameTokenizer now handles for '\' and '"' characters.
<li>SMIME v2 compliance has been added. Use setVersion(2) in the generator classes.
<li>The ASN.1 library now supports ENUMERATED, UniversalString and the X.509 library support for CRLs now includes CRLReason, and some elements of CertificatePolicies.
<li>Both the provider and the lightweight library now support a basic SIC mode for block ciphers.
</ul>
<h3>2.55.1 Version</h3>
Release: 1.14<br/>
Date:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2002, June 17
<h3>2.55.2 Defects Fixed</h3>
<ul>
<li>there was a bug in the BigInteger right shifting for > 31 bit shifts.
This has been fixed.
<li>x509 name had it's equality test based on the order of the directory
elements, this has been fixed.
<li>the mode used with the RSA cipher in KeyTransRecipientInfoParser in
the smime implementation was not compatible with the Sun JCE.
This has been fixed.
<li>PKCS7 SignedData now supports single length signing chains.
<li>When a root certificate had a different issuer id from the subject id, or
had it's own AuthorityKeyExtension the PKCS12 key store would drop the root
certificate from the certificate chain. This has been fixed.
<li>The PKCS10 CertificationRequestInfo class always expected at least one
attribute. This has been fixed.
<li>UTF8 strings are now correctly recognised.
<li>The Tiger implementation was producing results in reverse byte
order for each of the 3 words making up the digest. This has been fixed.
<li>asn1.x509.ExtendedKeyUsage used to through a null pointer exception
on construction. This has been fixed.
</ul>
<h3>2.55.3 Additional Functionality and Features</h3>
<ul>
<li>The BigInteger library now uses Montgomery numbers for modPow and is
substantially faster.
<li>SMIMECapabilities, and SMIMEEncryptionKeyPreference attributes added to S/MIME.
<li>Increased range of key sizes available in S/MIME.
<li>getInstance(ASN1TaggedObject, boolean) methods have been added to most ASN1 types.
These deal with implicit/explicit tagging ambiguities with constructed types.
<li>Added EncryptedPrivateKeyInfo object to the clean room JCE.
<li>A PEMReader has been added for handling some of the openSSL PEM files.
<li>The X.509 certificate factory supports a wider range of encodings and
object identifiers.
</ul>
<h3>2.56.1 Version</h3>
Release: 1.13<br/>
Date:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2002, April 19
<h3>2.56.2 Defects Fixed</h3>
<ul>
    <li>The TBSCertificate object in the ASN.1 library now properly implements
    the Time object, rather returning UTC time.
    <li>The DESedeKeyGenerator now supports 112 and 168 bit key generation.
    <li>Certificates with the keyId set to null in the AuthorityKeyIdentifier extensions would sometimes cause the PKCS12 store to throw a NullPointer exception. This has been fixed.
    <li>toByteArray in the big integer class was not always producing correct
    results for negative numbers. This has been Fixed.
</ul>

<h3>2.56.3 Additional Functionality and Features</h3>
<ul>
    <li>The key to keySpec handling of the secret key factories has been improved.
    <li>There is now a SMIME implementation and a more complete CMS
        implementation (see CONTRIBUTORS file for additonal details).
    <li>A CertPath implementation that runs under jdk1.1 and jdk1.4 has also
    being contributed. A work around to allow it to be used with jdk1.2 and
    jdk1.3 has also been added. Note: the implementation is not quite complete
    because policymapping, name and subtree constraints are not yet
    implemented.
    <li>The API now supports the generation of PKCS7 signed objects. Note: this
    is still beta code - one known issue is that it doesn't support single
    length certificate chains for signing keys.
</ul>

<h3>2.57.1 Version</h3>
Release: 1.12<br/>
Date:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2002, February 8
<h3>2.57.2 Defects Fixed</h3>
<ul>
    <li>The ASN.1 library was unable to read an empty set object. This has been fixed.
    <li>Returning sets of critical and non-critical extensions on X.509 certificates could result in a null pointer exception if the certificate had no extensions. This has been fixed.
    <li>The BC JKS implementation does not follow the conventional one - it has been renamed BKS, an attempt to create a JKS keystore using the BC provider will now result in an exception.
    <li>The PKCS 10 generator verify(provider) method was ignoring the provider when generating the public key. This has been fixed.
    <li>The PKCS12 store would throw an OutOfMemoryException if passed a non-PKCS12 file. This has been fixed.
    <li>In the case where there was no AuthorityKeyIdentifier the PKCS12 store
    would fail to find certificates further up the signing chain. The store now
    uses the IssuerDN if no AuthorityKeyIdentifier is specified and the IssuerDN
    is different from the SubjectDN,
    <li>PKCS10/CertificationRequestInfo objects with only a single attribute wer
    not being handled properly. This has been fixed.
    <li>getExtensionValue for X.509 CRLs was returning the value of the
    DER-Encoded octet string not the DER-Encoded octet string as required. This
    has been fixed.
    <li>the IV algorithm parameters class would improperly throw an exception
    on initialisation. This has been fixed.
</ul>
<h3>2.57.3 Additional Functionality and Features</h3>
<ul>
    <li>The AESWrap ciphers will now take IV's.
    <li>The DES-EDEWrap algorithm described in https://www.ietf.org/internet-drafts/draft-ietf-smime-key-wrap-01.txt is now supported.
    <li>Support for the ExtendedKeyUsageExtension and the KeyPurposeId has been added.
    <li>The OID based alias for DSA has been added to the JCE provider.
    <li>BC key stores now implement the BCKeyStore interface so you can provide your own source of randomness to a key store.
    <li>The ASN.1 library now supports GeneralizedTime.
    <li>HMACSHA256, HMACSHA384, and HMACSHA512 are now added.
    <li>PSS has been added to the JCE, PSS and ISO9796 signers in the lightweight api have been rewritten so they can be used incrementally. SHA256withRSA, SHA384withRSA, and SHA512withRSA have been added.
    <li>Base support for CMS (RFC 2630) is now provided (see CONTRIBUTORS file
    for details).
</ul>
<h3>2.58.1 Version</h3>
Release: 1.11<br/>
Date:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2001, December 10
<h3>2.58.2 Defects Fixed</h3>
<ul>
<li>X9.23 padding of MACs now works correctly with block size aligned data.
<li>Loading a corrupted "UBER" key store would occasionally cause the
appearance of hanging. This has been fixed.
<li>Loading a PKCS12 store where not all certificates had PKCS9 attributes
assigned to them would cause a NullPointerException. This has been fixed.
<li>The PKCS12 store wasn't correctly recovering certificate chains of
length less than 2 on calling the getCertificateChain method. This has been
fixed.
<li>Lone certificates were not been stored in the PKCS12 store. This has been fixed.
<li>CFB and OFB modes weren't padding iv's more than 1 byte less than the 
block size of the cipher if the mode was reused with a shorter IV. This has
been fixed.
<li>IV handling and block size return values for CFB and OFB modes wasn't being handled in the same way as the Sun reference implementation. This has been fixed.
<li>CertificateInfoRequests were not handling null attributes correctly. This
has been fixed.
<li>Tags for the X.509 GeneralName structure were wrongly encoded. This has been
fixed.
<li>getExtensionValue for X.509 certificates was returning the value of the
DER-Encoded octet string not the DER-Encoded octet string as required. This has
been fixed.
<li>reset on the version 3 X.509 certificate generator was not flushing the
extensions. This has been fixed.
<li>The NetscapeCert type bits were reversed! This has been fixed.
</ul>
<h3>2.58.3 Additional Functionality and Features</h3>
<ul>
<li>The lightweight API and the JCE provider now support ElGamal.
<li>X509Principal, and X509Name now supports the "DC" attribute and the
creation of directory names from vectors.
<li>RSA-PSS signature padding has been added to the lightweight API.
<li>EC Public/Private keys are now encoded in accordance with SEC 1. The library
will still read older keys as well.
<li>Added PKCS12-DEF a pkcs12 based key store which works around a bug in
the Sun keytool - it always uses the default provider for creating certificates.
<li>A cut down version of the Rijndael has been added that provides the functionality required to conform the the AES. It is designed to fully support FIPS-197. A fips AES wrapper (AESWrap in the JCE, AESWrapEngine in the lightweight library has also been added).
<li>Elliptic curve routines now handle uncompressed points as well as the
compressed ones.
</ul>
<h3>2.58.4 Other changes</h3>
<ul>
<li>As the range of public key types supported has expanded the getPublicKey
method on the SubjectPublicKeyInfo class is not always going to work. The
more generic method getPublicKeyData has been added and getPublicKey now
throws an IOException if there is a problem.
</ul>
<h3>2.59.1 Version</h3>
Release: 1.10<br/>
Date:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2001, October 20
<h3>2.59.2 Defects Fixed</h3>
<ul>
<li>The PKCS12 Key Store now interoperates with the JDK key tool. <b>Note:</b> this does mean the the key name passed to the setKeyEntry calls has become
significant.
<li>The "int" constructor for DERInteger only supported ints up to 128. This
has been fixed.
<li>The ASN.1 input streams now handle zero-tagged zero length objects correctly.
</ul>
<h3>2.59.3 Additional Functionality and Features</h3>
<ul>
<li>The JCE Provider and the lightweight API now support Serpent, CAST5, and CAST6.
<li>The JCE provider and the lightweight API now has an implementation of ECIES.
<b>Note:</b> this is based on a draft, don't use it for anything that needs to
be kept long term as it may be adjusted.
<li>Further work has been done on performance - mainly in the symmetric ciphers.
<li>Support for the generation of PKCS10 certification requests has been added.
</ul>
<h3>2.60.1 Version</h3>
Release: 1.09<br/>
Date:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2001, October 6
<h3>2.60.2 Defects Fixed</h3>
<ul>
<li>failure to pass in an RC5 parameters object now results in an exception
at the upper level of the JCE, rather than falling over in the lightweight
library.
<li>ISO10126Padding now incorporates the correct amount of random data.
<li>The PKCS12 key store wasn't picking up certificate chains properly
when being used to write PKCS12 files. This has been fixed.
<li>The Twofish engine would call System.exit if the key was too large.
This has been fixed.
<li>In some cases the ASN.1 library wouldn't handle implicit tagging properly.
This has been fixed.
</ul>
<h3>2.60.3 Additional Functionality and Features</h3>
<ul>
<li>Support for RC5-64 has been added to the JCE.
<li>ISO9796-2 signatures have been added to the JCE and lightweight API.
<li>A more general paddings packge for use with MACs and block ciphers had been aded to the lightweight API. MACs now allow you to specify padding.
<li>X9.23 Padding has been added to the JCE and lightwieght API. The old
PaddedBlockCipher class is now deprecated see org.bouncycastle.crypto.paddings for details.
<li>SHA-256, SHA-384, and SHA-512 are now added. Note: while the public review
period has finished, these algorithms have not yet been standardised, in the
event that final standardisation changes the algorithms these implementations
will be changed.
<li>It's now possible to set bag attributes on items to go into a PKCS12 store,
using the org.bouncycastle.jce.interfaces.PKCS12BagAttributeCarrier interface.
<li>More classses have been added to the ASN.1 package for dealing with
certificate extensions and CRLs including a CRL generator. Note: the
CRL generators should be regarded as under development and subject to change.
<li>There's now an examples package for the JCE (in addition to the examples
in org.bouncycastle.jce.provider.test) - org.bouncycastle.jce.examples. It
currently consists of a class showing how to generate a PKCS12 file.
<li>The X.509 CertificateFactory now includes CRL support.  DER or PEM CRLs may be processed.
<li>The BigInteger library has been written with a view to making it less
resource hungry and faster - whether it's fast enough remains to be seen!
</ul>

<h3>2.61.1 Version</h3>
Release: 1.08<br/>
Date:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2001, September 9
<h3>2.61.2 Defects Fixed</h3>
<ul>
<li>It wasn't possible to specify an ordering for distinguished names in
X509 certificates. This is now supported.
<li>In some circumstances stream Ciphers in the JCE would cause null pointer
exceptions on doFinal. This has been fixed.
<li>Unpadded ciphers would sometimes buffer the last block of input, even
if it could be processed. This has been fixed.
<li>The netscape certificate request class wouldn't compile under JDK 1.1. This
has been fixed.
</ul>
<h3>2.61.3 Additional Functionality and Features</h3>
<ul>
<li>ISO 9796-1 padding is now supported with RSA in the lightweight
API and the JCE.
<li>support classes have been added for reading and writing PKCS 12 files,
including a keystore for the JCA.
<li>The message digests MD4, Tiger, and RIPEMD128 have been added to the
JCE and the lightweight API. Note: MD4 and RIPEMD128 have been added for
compatibility purposes only - we recommend you don't use them for anything new!
<li>The JDK 1.1 certificate classes didn't conform to the JDK 1.2 API as
the collections class was not present. Thanks to a donated collections API
this is fixed.
</ul>
<h3>2.62.1 Version</h3>
Release: 1.07<br/>
Date:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2001, July 9
<h3>2.62.2 Defects Fixed</h3>
<ul>
<li>It turned out that the setOddParity method in the DESParameter class
was indeed doing something odd but not what was intended. This is now
fixed. <b>Note:</b>This will affect some PBE encryptions that were carried
out with DES, equivalent PBE ciphers to the old PBE DES cipher can be
accessed by prepending the work "Broken" in front of the original PBE cipher
call. If you want an example of how to deal with this as a migration issue
have a look in org.bouncycastle.jce.provider.JDKKeyStore lines 201-291.
</ul>
<h3>2.63.1 Version</h3>
Release: 1.06<br/>
Date:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2001, July 2
<h3>2.63.2 Defects Fixed</h3>
<ul>
<li>Diffie-Hellman keys are now properly serialisable as well as
encodable.
<li>Three of the semi-weak keys in the DESParameters, and the DESKeySpec look
up table, were incorrect. This has been fixed.
<li>DESEDE key generators now accept 112 and 168 as the key sizes, as well
as 128 and 192 (for those people who don't like to count the parity bits).
<li>Providing no strength parameter is passed to the DESede key generator in
the JCE provider, the provider now generates DESede keys in the k1-k2-k1
format (which is compatible with the Sun reference implementation), otherwise
you get what you ask for (3-DES or 2-DES in the minimum number of bytes).
<li>Base Diffie-Hellman key agreement now works correctly for more than two
parties.
<li>Cipher.getAlgorithmParameters was returing null in cases where a cipher
object had generated it's own IV. This has been fixed.
<li>An error in the key store occasionally caused checks of entry types to
result in a null pointer exception. This has been fixed.
<li>RSA key generator in JCE now recognises RSAKeyGenerationParameterSpec.
<li>Resetting and resusing HMacs in the lightweight and heavyweight libraries
caused a NullPointer exception. This has been fixed.
</ul>

<h3>2.63.3 Additional Functionality</h3>
<ul>
<li>ISO10126Padding is now recognised explicitly for block ciphers
as well.
<li>The Blowfish implementation is now somewhat faster.
</ul>

<h3>2.64.1 Version</h3>
Release: 1.05<br/>
Date:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2001, April 17
<h3>2.64.2 Defects Fixed</h3>
<ul>
<li>The DESEDE key generator can now be used to generate 2-Key-DESEDE
keys as well as 3-Key-DESEDE keys.
<li>One of the weak keys in the DESParameters, and the DESKeySpec look
up table, was incorrect. This has been fixed.
<li>The PKCS12 generator was only generating the first 128-160 bits of the
key correctly (depending on the digest used). This has been fixed.
<li>The ASN.1 library was skipping explicitly tagged objects of zero length.
This has been fixed.
</ul>
<h3>2.64.3 Additional Functionality</h3>
<ul>
<li>There is now an org.bouncycastle.jce.netscape package which has
a class in for dealing with Netscape Certificate Request objects.
</ul>
<h3>2.64.4 Additional Notes</h3>
<p>
Concerning the PKCS12 fix: in a few cases this may cause some backward
compatibility issues - if this happens to you, drop us a line at
<a href="mailto:feedback-crypto@bouncycastle.org">feedback-crypto@bouncycastle.org</a>
and we will help you get it sorted out.

<h3>2.65.1 Version</h3>
Release: 1.04<br/>
Date:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2001, March 11
<h3>2.65.2 Defects Fixed</h3>
<ul>
<li>Signatures generated by other providers that include optional null
parameters in the AlgorithmIdentifier are now handled correctly by the
provider.
<li>The JCE 1.2.1 states that the names of algorithms associated with the JCE
are case insensitive. The class that matches algorithms to names now tries
to match the name given with it's equivalent in upper case, before trying
to match it as given. If you write a provider and include versions of your
algorithm names in uppercase only, this JCE implementation will always
match a getInstance regardless of the case of the algorithm passed into
the getInstance method.
<li>If the JCE API and the Provider were in a different class path, the
class loader being used sometimes failed to find classes for JCE Ciphers, etc.
This has been fixed.
<li>An error in the ASN.1 library was causing problems serialising Diffie-Hellman keys. This has been fixed.
<li>The agreement package was left out of the j2me bat file. This has been fixed.
<li>The BigInteger class for 1.0 and the j2me wasn't able to generate random
integers (prime or otherwise). This has been fixed. 
<li>The BigInteger class would sometimes go into a death spiral if the any
32nd bit of an exponent was set when modPow was called. This has been fixed. 
<li>Cipher.getInstance would treat "//" in a transformation as a single "/".
This has been fixed.
<li>PBEWithSHAAndIDEA-CBC was throwing an exception on initialisation. This has
been fixed.
<li>The X509Name class in the asn1.x509 package wasn't initialising its local
hash table when the hash table constructor was called. This has been fixed.
</ul>

<h3>2.65.3 Additional Functionality</h3>
<ul>
<li>Added Elliptic Curve DSA (X9.62) - ECDSA - to provider and lightweight
library.
<li>Added Elliptic Curve basic Diffie-Hellman to provider and lightweight
library.
<li>Added DSA support to the provider and the lightweight library.
<li>Added super class interfaces for basic Diffie-Hellman agreement classes
to lightweight library.
<li>The certificate generators now support ECDSA and DSA certs as well.
</ul>

<h3>2.66.1 Version</h3>
Release: 1.03<br/>
Date:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2001, January 7
<h3>2.66.2 Defects Fixed</h3>
<ul>
<li>CFB and OFB modes when specified without padding would insist on input
being block aligned. When specified without padding CFB and OFB now behave in a compatible 
fashion (a doFinal on a partial block will yield just the data that could
be processed).
In short, it provides another way of generating cipher text the same
length as the plain text.
</ul>

<h3>2.66.1 Version</h3>
Release: 1.02<br/>
Date:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2000, November 7
<h3>2.66.2 Defects Fixed</h3>
<ul>
<li>The RSA key pair generator occasionally produced keys 1 bit under the
requested size. This is now fixed.
</ul>

<h3>2.67.1 Version</h3>
Release: 1.01<br/>
Date:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2000, October 15
<h3>2.67.2 Defects Fixed</h3>

<ul>
<li>Buffered ciphers in lightweight library were not resetting correctly
on a doFinal. This has been fixed.
</ul>

<h3>2.68.1 Version</h3>
Release: 1.00<br/>
Date:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2000, October 13
<h3>2.68.2 Defects Fixed</h3>
<p>
<ul>
<li>JDK1.2 version now works with keytool for certificate generation.
<li>Certificate toString method no longer throws a null pointer exception
if a group [3] extension has not been added.
<li>Under some circumstances the NullCipher would throw a NullPointerException,
this has been fixed.
<li>Under some circumstances CipherInputStream would throw a NullPointerException, this has been fixed.
<li>OpenSSL/SSLeay private key encodings would cause an exception to be thrown
by the RSA key factory. This is now fixed.
<li>The Cipher class always used the default provider even when one was specified, this has been fixed.
<li>Some DES PBE algorithms did not set the parity correctly in generated keys, this has been fixed.
</ul>

<h3>2.68.3 Additional functionality</h3>
<p>
<ul>
<li>Argument validation is much improved.
<li>An X509KeyUsage class has been added to the JCE class to make it easier
to specify the KeyUsage extension on X.509 certificates.
<li>The library now allows creation of version 1 certificates as well.
</ul>

<h3>3.0 Notes</h3>
<p>
The J2ME is only supported under Windows.
<p>
If you are trying to use the lightweight provider in a JDK 1.0 applet, you
need to change the package names for java.math.BigInteger, java.lang.IllegalStateException, and java.security.SecureRandom
<p>
The RSA test under JDK 1.0 and J2ME takes a while to run...
</body>
</html>
