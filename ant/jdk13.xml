<?xml version="1.0" encoding="UTF-8"?>

<project name="crypto1.3" default="build" basedir="..">

    <property file="ant/build.regexp" />

    <property name="bc.javac.source" value="1.3" />
    <!-- 1.1 is intended, it is the default value used by JDKs 1.1. thru 1.3 -->
    <property name="bc.javac.target" value="1.1" />
    <property name="build.dir" value="build" />
    <property name="jdk.name" value="jdk1.3" />
    <property name="src.dir" value="${build.dir}/${jdk.name}" />
    <property name="artifacts.dir" value="${build.dir}/artifacts/${jdk.name}" />
    <property name="target.prefix" value="jdk13" />
    <property name="javadoc.args" value="-protected" />

    <target name="init">
        <mkdir dir="${src.dir}" />
        <mkdir dir="${artifacts.dir}" />
        <mkdir dir="${artifacts.dir}/reports" />
        <mkdir dir="${artifacts.dir}/reports/xml" />
        <mkdir dir="${artifacts.dir}/reports/html" />
        <mkdir dir="${artifacts.dir}/jars" />
        <mkdir dir="${artifacts.dir}/checkstyle" />
        <copy todir="${src.dir}">
            <fileset dir="core/src/main/javadoc"/>
            <fileset dir="mail/src/main/javadoc"/>
            <fileset dir="pg/src/main/javadoc"/>
            <fileset dir="pkix/src/main/javadoc"/>
            <fileset dir="prov/src/main/javadoc"/>
            <fileset dir="core/src/main/java">
                <exclude name="**/ECPointUtil.java" />
                <exclude name="**/ECNamedCurveSpec.java" />
                <exclude name="**/LDAP*.java" />
                <exclude name="**/X509LDAP*.java" />
                <exclude name="**/X509StoreLDAP*.java" />
                <exclude name="**/BCEC*.java" />
                <exclude name="**/JCEEC5*.java" />
                <exclude name="**/provider/JCEEC*.java" />
                <exclude name="**/EC5*.java" />
                <exclude name="**/CertPathReviewer*.java" />
                <exclude name="**/PKIXCertPathReviewer.java" />
                <exclude name="**/PKIXAttrCert*.java" />
                <exclude name="**/PKIXNameConstraints*.java" />
                <exclude name="**/ExtendedPKIX*.java" />
                <exclude name="**/RFC3281*.java" />
                <exclude name="**/CertPathValidatorUtilities.java" />
                <exclude name="**/JDKPKCS12StoreParameter.java" />
                <exclude name="**/NTRU*.java" />
                <exclude name="**/IndexGenerator.java" />
                <exclude name="**/ntru/**/*.java" />
                <exclude name="**/xmss/**/*.java" />
                <exclude name="**/asymmetric/DSTU*.java" />
                <exclude name="**/asymmetric/dstu/*.java" />
                <exclude name="**/provider/config/PKCS12StoreParameter.java" />
            </fileset>
            <fileset dir="prov/src/main/java">
                <exclude name="**/BCFKSStoreParameter.java" />
                <exclude name="**/ec/ECUtils.java" />
                <exclude name="**/ECPointUtil.java" />
                <exclude name="**/ECNamedCurveSpec.java" />
                <exclude name="**/LDAP*.java" />
                <exclude name="**/X509LDAP*.java" />
                <exclude name="**/X509StoreLDAP*.java" />
                <exclude name="**/BCEC*.java" />
                <exclude name="**/JCEEC5*.java" />
                <exclude name="**/provider/JCEEC*.java" />
                <exclude name="**/EC5*.java" />
                <exclude name="**/CertPathReviewer*.java" />
                <exclude name="**/PKIXCertPathReviewer.java" />
                <exclude name="**/PKIXAttrCert*.java" />
                <exclude name="**/PKIXNameConstraints*.java" />
                <exclude name="**/PKCS12StoreParameter.java" />
                <exclude name="**/ExtendedPKIX*.java" />
                <exclude name="**/RFC3281*.java" />
                <exclude name="**/CertPathValidatorUtilities.java" />
                <exclude name="**/JDKPKCS12StoreParameter.java" />
                <exclude name="**/NTRU*.java" />
                <exclude name="**/XMSS*.java" />
                <exclude name="**/IndexGenerator.java" />
                <exclude name="**/ntru/**/*.java" />
                <exclude name="**/xmss/**/*.java" />
                <exclude name="**/ecgost12/**/*.java" />
                <exclude name="**/asymmetric/DSTU*.java" />
                <exclude name="**/asymmetric/dstu/*.java" />
                <exclude name="**/provider/config/PKCS12StoreParameter.java" />
            </fileset>
            <fileset dir="pkix/src/main/java">
                <exclude name="**/cert/jcajce/JcaAttributeCertificateIssuer.java" />
                <exclude name="**/est/**/*.java" />
            </fileset>
            <fileset dir="pg/src/main/java">
            </fileset>
            <fileset dir="mail/src/main/java">
                <exclude name="**/ValidateSignedMail.java" />
                <exclude name="**/validator/*.java" />
            </fileset>
            <fileset dir="core/src/test/java">
                <exclude name="**/MQVTest.java" />
                <exclude name="**/ECDSA5Test.java" />
                <exclude name="**/NamedCurveTest.java" />
                <exclude name="**/nist/NistCertPathTest.java" />
                <exclude name="**/nist/NistCertPathReviewerTest.java" />
                <exclude name="**/CRL5Test.java" />
                <exclude name="**/DetDSA*.java" />
                <exclude name="**/SignedMailValidatorTest.java" />
                <exclude name="**/LocalizedMessageTest.java" />
                <exclude name="**/DummyCertPathReviewer.java" />
                <exclude name="**/X509LDAP*.java" />
                <exclude name="**/tls/test/*.java" />
                <exclude name="**/PKIXNameConstraintsTest.java" />
                <exclude name="**/MiscDataStreamTest.java" />
                <exclude name="**/GetInstanceTest.java" />
                <exclude name="**/ntru/**/*.java" />
                <exclude name="**/NTRU*.java" />
                <exclude name="**/XMSS*.java" />
                <exclude name="**/crypto/engines/test/BitStringTest.java" />
                <exclude name="**/crypto/engines/test/AllTests.java" />
                <exclude name="**/crypto/signers/test/AllTests.java" />
                <exclude name="**/BcCertTest.java" />
                <exclude name="**/provider/test/DSTU4145Test.java" />
                <exclude name="**/PGPUnicodeTest.java" />
                <exclude name="**/pqc/**/EncryptionKeyTest.java" />
                <exclude name="**/pqc/**/BitStringTest.java" />
                <exclude name="**/jcajce/provider/test/*.java" />
                <exclude name="**/jce/provider/test/JceTestUtil.java" />
                <exclude name="**/speedy/**" />
                <exclude name="**/cavp/**" />
                <exclude name="**/KDFFeedbackGeneratorTest.java" />
                <exclude name="**/KDFDoublePipelineIteratorGeneratorTest.java" />
                <exclude name="**/KDFCounterGeneratorTest.java" />
                <exclude name="**/jce/provider/test/AEADTest.java" />
            </fileset>
            <fileset dir="prov/src/test/java">
                <exclude name="**/MQVTest.java" />
                <exclude name="**/ECDSA5Test.java" />
                <exclude name="**/NamedCurveTest.java" />
                <exclude name="**/nist/NistCertPathTest.java" />
                <exclude name="**/nist/NistCertPathReviewerTest.java" />
                <exclude name="**/CRL5Test.java" />
                <exclude name="**/DetDSA*.java" />
                <exclude name="**/LocalizedMessageTest.java" />
                <exclude name="**/X509LDAP*.java" />
                <exclude name="**/tls/test/*.java" />
                <exclude name="**/SunProviderTest.java" />
                <exclude name="**/NullProviderTest.java" />
                <exclude name="**/PKIXNameConstraintsTest.java" />
                <exclude name="**/MiscDataStreamTest.java" />
                <exclude name="**/GetInstanceTest.java" />
                <exclude name="**/ntru/**/*.java" />
                <exclude name="**/NTRU*.java" />
                <exclude name="**/crypto/engines/test/BitStringTest.java" />
                <exclude name="**/crypto/engines/test/AllTests.java" />
                <exclude name="**/crypto/signers/test/AllTests.java" />
                <exclude name="**/BcCertTest.java" />
                <exclude name="**/AlgorithmParametersTest.java" />
                <exclude name="**/provider/test/DSTU4145Test.java" />
                <exclude name="**/PGPUnicodeTest.java" />
                <exclude name="**/pqc/**/EncryptionKeyTest.java" />
                <exclude name="**/pqc/**/BitStringTest.java" />
                <exclude name="**/jcajce/provider/test/*.java" />
                <exclude name="**/jce/provider/test/JceTestUtil.java" />
                <exclude name="**/speedy/**" />
                <exclude name="**/cavp/**" />
                <exclude name="**/KDFFeedbackGeneratorTest.java" />
                <exclude name="**/KDFDoublePipelineIteratorGeneratorTest.java" />
                <exclude name="**/PSSTest.java" />
                <exclude name="**/KDFCounterGeneratorTest.java" />
                <exclude name="**/jce/provider/test/AEADTest.java" />
            </fileset>
            <fileset dir="pkix/src/test/java">
                <exclude name="**/SunProviderTest.java" />
                <exclude name="**/NullProviderTest.java" />
                <exclude name="**/CertPathLoopTest.java" />
                <exclude name="**/TimeStampTokenInfoUnitTest.java" />
                <exclude name="**/est/**/*.java" />
            </fileset>
            <fileset dir="mail/src/test/java">
                <exclude name="**/SignedMailValidatorTest.java" />
                <exclude name="**/DummyCertPathReviewer.java" />
            </fileset>
            <fileset dir="mail/src/test/resources" />
            <fileset dir="prov/src/main/resources" includes="**/*.properties" />
            <fileset dir="core/src/test/javadoc" includes="**/*.html" />
            <fileset dir="core/src/test/resources" includes="**/*.properties" />
            <fileset dir="core/src/test/resources" includes="**/*.txt" />
            <fileset dir="core/src/test/resources" includes="**/*.rsp" />
            <fileset dir="core/src/test/resources" includes="**/*.data" />
            <fileset dir="core/src/test/resources" includes="**/*.pem" />
            <fileset dir="prov/src/test/resources" includes="**/*.pem" />
            <fileset dir="prov/src/test/resources" includes="**/*.p12" />
            <fileset dir="prov/src/test/resources" includes="**/*.cer" />
            <fileset dir="prov/src/test/resources" includes="**/*.crl" />
            <fileset dir="pkix/src/test/resources" includes="**/*.pem" />
            <fileset dir="pkix/src/test/resources" includes="**/*.der" />
            <fileset dir="pkix/src/test/resources" includes="**/*.data" />
            <fileset dir="pkix/src/test/resources" includes="**/*.sig" />
            <fileset dir="pkix/src/test/resources" includes="**/*.p7m" />
            <fileset dir="pkix/src/test/resources" includes="**/*.cvcert" />
            <fileset dir="pkix/src/test/resources" includes="**/*.csr" />
            <fileset dir="core/src/test/data" includes="**/*.properties" />
            <fileset dir="core/src/test/data" includes="**/*.eml" />
            <fileset dir="core/src/test/data" includes="**/*.p12" />
            <fileset dir="core/src/test/data" includes="**/*.crt" />
            <fileset dir="core/src/test/data" includes="**/*.crl" />
            <fileset dir="core/src/test/data" includes="**/*.sig" />
            <fileset dir="core/src/test/data" includes="**/*.data" />
            <fileset dir="core/src/test/data" includes="**/*.message" />
            <fileset dir="core/src/test/data" includes="**/*.der" />
            <fileset dir="core/src/test/data" includes="**/*.csr" />
            <fileset dir="core/src/test/data" includes="**/*.cer" />
            <fileset dir="core/src/test/data" includes="**/*.p7m" />
            <fileset dir="core/src/test/data" includes="**/*.cvcert" />
            <fileset dir="mail/src/test/resources" />
        </copy>
        <copy todir="${src.dir}" overwrite="true">
            <fileset dir="core/src/main/jdk1.4" includes="**/*.java" />
            <fileset dir="prov/src/main/jdk1.4" includes="**/*.java" >
                <exclude name="**/LDAP*.java" />
            </fileset>
            <fileset dir="pkix/src/main/jdk1.4" includes="**/*.java" />
            <fileset dir="pg/src/main/jdk1.4" includes="**/*.java" />
            <fileset dir="core/src/test/jdk1.4" includes="**/*.java" />
        </copy>
        <copy todir="${src.dir}" overwrite="true">
            <fileset dir="prov/src/test/jdk1.4" includes="**/*.java" />
            <fileset dir="pkix/src/test/jdk1.4" includes="**/*.java" />
            <fileset dir="mail/src/test/jdk1.4" includes="**/*.java" />
        </copy>
        <copy todir="${src.dir}" overwrite="true">
            <fileset dir="core/src/main/jdk1.3" includes="**/*.java" />
            <fileset dir="prov/src/main/jdk1.3" includes="**/*.java" />
            <fileset dir="pkix/src/main/jdk1.3" includes="**/*.java" />
            <fileset dir="core/src/test/jdk1.3" includes="**/*.java" />
            <fileset dir="prov/src/test/jdk1.3" includes="**/*.java" />
            <fileset dir="pkix/src/test/jdk1.3" includes="**/*.java" />
        </copy>
        <copy todir="${src.dir}">
            <fileset dir="jce/src" includes="**/*.java" />
        </copy>

        <replaceregexp match="${regexp}" replace=" " flags="g" byline="true">
            <fileset dir="${src.dir}">
              <include name="**/*.java"/>
            </fileset>
        </replaceregexp>
        <replaceregexp match="java.security.cert.CertStore" replace="org.bouncycastle.jce.cert.CertStore" flags="g" byline="true">
            <fileset dir="${src.dir}">
              <include name="**/*.java"/>
            </fileset>
        </replaceregexp>
        <replaceregexp match="java.security.cert.PKIX" replace="org.bouncycastle.jce.cert.PKIX" flags="g" byline="true">
            <fileset dir="${src.dir}">
              <include name="**/*.java"/>
            </fileset>
        </replaceregexp>
        <replaceregexp match="java.security.cert.(.*Selector)" replace="org.bouncycastle.jce.cert.\1" flags="g" byline="true">
            <fileset dir="${src.dir}">
              <include name="**/*.java"/>
            </fileset>
        </replaceregexp>
        <replaceregexp match="java.security.cert.CertPath" replace="org.bouncycastle.jce.cert.CertPath" flags="g" byline="true">
            <fileset dir="${src.dir}">
              <include name="**/*.java"/>
            </fileset>
        </replaceregexp>

    </target>

    <target name="build" depends="init">
        <ant antfile="ant/bc+-build.xml" dir="." />
        <ant antfile="ant/bc+-build.xml" dir="." target="javadoc-lw" />
        <ant antfile="ant/bc+-build.xml" dir="." target="javadoc-libraries" />
    </target>

    <target name="build-lw" depends="init">
        <ant antfile="ant/bc+-build.xml" dir="." target="build-lw" />
        <ant antfile="ant/bc+-build.xml" dir="." target="javadoc-lw" />
    </target>

    <target name="build-provider" depends="init">
        <ant antfile="ant/bc+-build.xml" dir="." target="build-provider" />
        <ant antfile="ant/bc+-build.xml" dir="." target="javadoc-provider" />
    </target>

    <target name="build-jce" depends="init">
        <ant antfile="ant/bc+-build.xml" dir="." target="build-jce" />
        <ant antfile="ant/bc+-build.xml" dir="." target="javadoc-jce" />
    </target>

    <target name="build-test" depends="init">
        <ant antfile="ant/bc+-build.xml" dir="." target="build-test" />
    </target>

    <target name="test" depends="build-test">
        <ant antfile="ant/bc+-build.xml" dir="." target="test" />
    </target>

    <target name="zip-src">
        <ant antfile="ant/bc+-build.xml" dir="." target="zip-src" />
    </target>

    <target name="zip-src-provider">
        <ant antfile="ant/bc+-build.xml" dir="." target="zip-src-provider" />
    </target>

</project>
